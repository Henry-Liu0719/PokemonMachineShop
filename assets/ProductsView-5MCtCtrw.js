import{_ as q,a as u,m as p,r as O,o as i,c as d,b as t,d as h,w as m,n as a,F as l,g as _,i as x,t as n,j as S,h as j}from"./index-JmAIW8yy.js";import{p as N}from"./productStore-iDHkri97.js";import{p as T}from"./pokemonStore-NKdNfK0u.js";import{f as F}from"./favoriteStore-mgc5_d5L.js";import{_ as V}from"./Animation - 1710557059960-SOXLnD8x.js";import"./axios-G2rPRu76.js";const W={data(){return{yOffset:0,filterdProducts:{},searchedProducts:{},typeSelected:"全部"}},components:{},mounted(){console.log(this.favorites),this.init(),this.yOffset=document.querySelector("div.container.mt-md-5.mt-3.mb-7 > div > div.col-8 > div > h4").getBoundingClientRect().top+window.pageYOffset},computed:{...u(N,["products","isProductsLoading","allProducts"]),...u(T,["typeNameList"]),...u(F,["favorites"])},watch:{async products(){this.filterdProducts={...this.products},console.log(this.filterdProducts),this.$route.query.keyWord&&await this.getAllProducts()},allProducts(){this.filterdProducts={...this.allProducts},this.createSearchedProducts()}},methods:{...p(N,["openModal","addToCart","getProducts","filterType","getAllProducts"]),...p(T,["exportTypeNamesList"]),...p(F,["addToFavorites","removeFromFavorites","getFavorites"]),async init(){const s=this.$route.query.category||"";await this.getProducts(1,0,s),this.exportTypeNamesList()},filterType(s="岩石"){this.filterdProducts.products=this.products.products.filter(r=>r.unit===s),window.scrollTo({top:this.yOffset,behavior:"smooth"})},async createSearchedProducts(){const s=this.$route.query.keyWord;console.log("this.filterdProducts",this.filterdProducts),this.searchedProducts={success:!0,products:[],pagination:{total_pages:1,current_page:1,has_pre:!1,has_next:!1,category:""},messages:[]},this.searchedProducts.products=this.filterdProducts.products.filter(r=>r.description.includes(s)||r.unit.includes(s)),console.log("this.searchedProducts",this.searchedProducts),this.filterdProducts={...this.searchedProducts}}}},B=t("div",{class:"container"},null,-1),A={class:"container mt-md-5 mt-3 mb-7"},E=t("img",{src:V,alt:"",class:"img-fluid"},null,-1),$={class:"row"},M={class:"col-4"},z={class:"accordion border border-bottom border-top-0 border-start-0 border-end-0 mb-3",id:"accordionExample"},D={class:"card border-0"},R=t("div",{class:"card-header px-0 py-4 bg-white border border-bottom-0 border-top border-start-0 border-end-0 rounded-0",id:"headingOne","data-bs-toggle":"collapse","data-bs-target":"#collapseOne"},[t("div",{class:"d-flex justify-content-between align-items-center pe-1"},[t("h4",{class:"mb-0"}," 屬性瀏覽 ")])],-1),U={id:"collapseOne",class:"collapse show","aria-labelledby":"headingOne","data-bs-parent":"#accordionExample"},Y={class:"card-body py-0"},G={class:"list-unstyled"},H=["onClick"],I={class:"col-8"},J={class:"row"},K={class:"card border-0 mb-4 position-relative position-relative"},Q=["src"],X=["onClick"],Z=t("i",{class:"bi bi-heart"},null,-1),tt=t("span",{class:"visually-hidden"},"unread messages",-1),et=[Z,tt],st=["onClick"],ot=t("i",{class:"bi bi-heart"},null,-1),rt=t("span",{class:"visually-hidden"},"unread messages",-1),it=[ot,rt],dt={class:"card-body p-0"},at={class:"mb-0 mt-3"},nt={class:"card-text mb-0"},ct={class:"text-muted"},lt=t("p",{class:"text-muted mt-3"},null,-1),ut={key:0,class:"d-flex justify-content-center"},pt={class:"pagination"},ht={class:"page-item"},mt=t("span",{"aria-hidden":"true"},"«",-1),_t=[mt],gt=["onClick"],ft={class:"page-item"},bt=t("span",{"aria-hidden":"true"},"»",-1),yt=[bt];function vt(s,r,Pt,kt,o,wt){var f,b,y,v,P,k,w,C;const L=O("loadingOverlay"),g=O("router-link");return i(),d(l,null,[B,t("div",A,[h(L,{active:s.isProductsLoading,"is-full-page":!0},{default:m(()=>[E]),_:1},8,["active"]),t("div",$,[t("div",M,[t("div",z,[t("div",D,[R,t("div",U,[t("div",Y,[t("ul",G,[t("li",null,[t("button",{href:"#",class:a(["m-1 page-link py-1 px-2 d-block text-mute",{"text-primary rounded border border-primary":o.typeSelected=="全部"}]),onClick:r[0]||(r[0]=e=>{o.typeSelected="全部",this.$route.query.keyWord="",s.isLoading=!0,s.getProducts(1,o.yOffset,"")})},"瀏覽全部",2)]),(i(!0),d(l,null,_(Object.entries(s.typeNameList),e=>(i(),d("li",{key:e[0]},[t("button",{href:"#",class:a(["m-1 page-link py-1 px-2 d-block text-mute",{"text-primary rounded border border-primary":o.typeSelected==e[0]}]),onClick:c=>{this.typeSelected=e[0],this.$route.query.keyWord="",s.isLoading=!0,s.getProducts(1,o.yOffset,e[1])}},n(e[1]),11,H)]))),128))])])])])])]),t("div",I,[t("div",J,[t("h4",{class:a(["opacity-0 mt-6",{"opacity-100":!((f=o.filterdProducts.products)!=null&&f.length)}])},"無相符的查詢結果",2),(i(!0),d(l,null,_(o.filterdProducts.products,e=>(i(),d("div",{class:"col-12 col-md-4 col-lg-3",key:e.id},[t("div",K,[h(g,{to:{path:"product",query:{id:e.id}}},{default:m(()=>[t("img",{src:e.imageUrl,class:"card-img-top object-fit-contain position-relative rounded border border-1 border-secondary",alt:"product.description",style:{width:"100%"}},null,8,Q)]),_:2},1032,["to"]),t("span",null,[s.favorites.some(c=>c.id===e.id)?(i(),d("button",{key:1,type:"button",class:"position-absolute top-0 start-100 badge bg-primary border-0",style:{transform:"translate(-100%, 0)",width:"3rem",height:"1.5rem","border-radius":"0 0.375rem"},onClick:S(c=>s.removeFromFavorites(e.id),["prevent"])},it,8,st)):(i(),d("button",{key:0,type:"button",class:"position-absolute top-0 start-100 badge bg-secondary border-0",style:{transform:"translate(-100%, 0)",width:"3rem",height:"1.5rem","border-radius":"0 0.375rem"},onClick:S(c=>s.addToFavorites(e),["prevent"])},et,8,X))]),t("div",dt,[h(g,{to:{path:"product",query:{id:e.id}},style:{"text-decoration":"none"}},{default:m(()=>[t("h4",at,n(e.content)+" "+n(e.unit),1)]),_:2},1032,["to"]),t("p",nt,[j("NT$"+n(e.price)+" ",1),t("span",ct,[t("del",null,"NT$"+n(e.origin_price),1)])]),lt])])]))),128))]),!((y=(b=o.filterdProducts)==null?void 0:b.products)!=null&&y.length)==0?(i(),d("nav",ut,[t("ul",pt,[t("li",ht,[t("button",{class:a(["page-link",{disabled:!((P=(v=o.filterdProducts)==null?void 0:v.pagination)!=null&&P.has_pre)}]),"aria-label":"Previous",onClick:r[1]||(r[1]=e=>s.getProducts(s.products.pagination.current_page-1,o.yOffset))},_t,2)]),(i(!0),d(l,null,_((k=o.filterdProducts.pagination)==null?void 0:k.total_pages,e=>(i(),d("li",{class:a(["page-item",{active:o.filterdProducts.pagination.current_page==e}]),key:e},[t("button",{class:"page-link",onClick:c=>s.getProducts(e,o.yOffset)},n(e),9,gt)],2))),128)),t("li",ft,[t("button",{class:a(["page-link",{disabled:!((C=(w=o.filterdProducts)==null?void 0:w.pagination)!=null&&C.has_next)}]),"aria-label":"Next",onClick:r[2]||(r[2]=e=>s.getProducts(s.products.pagination.current_page+1,o.yOffset))},yt,2)])])])):x("",!0)])])])],64)}const Lt=q(W,[["render",vt]]);export{Lt as default};
