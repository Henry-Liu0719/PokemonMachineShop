import{_ as I,m as k,k as j,S as x,a as T,r as L,o as e,c as i,d as r,e as a,b as t,h as u,F as S,g as V,l as P,v as E,n as q,t as n,q as A,i as U}from"./index-1BOxTqVS.js";import{c as $}from"./cartStore-SkugQs_N.js";import{p as N}from"./productStore-3Se7VwP2.js";import{_ as b}from"./Animation - 1710557059960-SOXLnD8x.js";var O={VITE_URL:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"popovgo",VITE_POKEMON_API:"https://pokeapi.co/api/v2",BASE_URL:"/PokemonMachineShop/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:R,VITE_PATH:D}=O,M={data(){return{productId:"",num:1,couponCode:""}},mounted(){this.getCart(),this.getProducts()},methods:{...k($,["getCart","deleteCart","updateCart","deleteCarts"]),...k(N,["openModal","addToCart","getProducts","filterType","getAllProducts"]),postCoupon(s){this.isUpdating=!0;const d={data:{code:`${s}`}};j.post(`${R}/api/${D}/coupon`,d).then(h=>{this.getCart(),x.fire({title:"使用優惠券成功",icon:"success",timer:1e3,showConfirmButton:!1,showCancelButton:!1})}).catch(h=>{x.fire({position:"top-end",icon:"error",title:`${h.response.data.message}`,showConfirmButton:!1,timer:1e3}),console.dir(h)}).finally(()=>{this.isUpdating=!1})}},computed:{...T($,["carts","isCartsLoading"]),...T(N,["products","isProductsLoading","allProducts"])},watch:{num(){this.num=this.num<1?1:this.num}}},F={class:"container"},H=t("img",{src:b,alt:"讀取中",class:"img-fluid"},null,-1),z={class:"mt-3 fs-4"},K=t("h3",{class:"mt-3 mb-4 fs-1"},"購物車",-1),G={key:0,class:"p-0 container d-flex"},J=t("h4",{class:"my-auto"},"購物車無商品",-1),Q=t("div",{class:"my-auto"},"前往產品列表",-1),W={key:1,class:"row"},X={class:"col-12 col-xl-9"},Y={class:"table"},Z=t("thead",null,[t("tr",null,[t("th",{scope:"col",class:"border-0 ps-0 col-4 col-xl-6"},"品名"),t("th",{scope:"col",class:"border-0"},"數量"),t("th",{scope:"col",class:"border-0 col-3 col-xl-2"},"小計"),t("th",{scope:"col",class:"border-0 col-1"})])],-1),tt={scope:"row",class:"border-0 px-0 font-weight-normal py-4"},ot=["src"],st={class:"mb-0 fw-bold ms-3 d-inline-block"},et={class:"border-0 align-middle",style:{"max-width":"160px"}},it={class:"input-group"},nt={class:"input-group-prepend"},dt=["onClick"],lt=t("i",{class:"bi bi-dash"},null,-1),at=[lt],ct=["onUpdate:modelValue"],rt={class:"input-group-append"},ut=["onClick"],pt=t("i",{class:"bi bi-plus"},null,-1),_t=[pt],ht={class:"border-0 align-middle"},bt={class:"mb-0 ms-auto"},mt={class:"border-0 align-middle"},ft=["onClick"],gt={class:"input-group mb-3 d-flex justify-content-between"},yt={class:"input-group-append d-flex flex-grow-1"},vt=["disabled"],Ct={class:"text-end d-inline-block"},wt=["disabled"],kt={class:"col-xl-3"},xt={class:"border p-4 mb-4"},Tt=t("h4",{class:"fw-bold mb-4"},"訂單詳情",-1),Lt={class:"d-flex justify-content-between mt-4"},St=t("p",{class:"mb-0 h4 fw-bold"},"商品數量",-1),Vt={class:"mb-0 h4 fw-bold"},Pt={key:0,class:"d-flex justify-content-between mt-4"},Et=t("p",{class:"mb-0 h4 fw-bold"},"優惠折扣",-1),qt={class:"mb-0 h4 fw-bold"},Ut={class:"d-flex justify-content-between mt-4"},$t=t("p",{class:"mb-0 h4 fw-bold"},"總額",-1),Nt={class:"mb-0 h4 fw-bold"},Bt={class:"col-12"},It=t("h3",{class:"my-3"},"查看更多商品",-1),jt={class:"vl-parent"},At={key:0,src:b,alt:"讀取中",class:"img-fluid opacity-0"},Ot=t("img",{src:b,alt:"讀取中",class:"img-fluid"},null,-1),Rt={class:"row"},Dt={class:"card border-0 mb-4 position-relative position-relative"},Mt=["src"],Ft={class:"card-body p-0"},Ht={class:"mb-0 mt-3"},zt={class:"card-text mb-0"},Kt={class:"text-muted"},Gt={key:0},Jt=t("p",{class:"text-muted mt-3"},null,-1);function Qt(s,d,h,Wt,c,B){var f,g,y,v,C,w;const m=L("loadingOverlay"),p=L("router-link");return e(),i("div",F,[r(m,{active:s.isCartsLoading,"is-full-page":!0},{default:a(()=>[H]),_:1},8,["active"]),t("div",z,[K,(f=s.carts.carts)!=null&&f.length?u("",!0):(e(),i("div",G,[J,r(p,{class:"btn btn-danger rounded w-auto mx-2 mb-2",to:"products"},{default:a(()=>[Q]),_:1})])),(g=s.carts.carts)!=null&&g.length?(e(),i("div",W,[t("div",X,[t("table",Y,[Z,t("tbody",null,[(e(!0),i(S,null,V(s.carts.carts,o=>{var _;return e(),i("tr",{key:o.id,class:"border-bottom border-top"},[t("th",tt,[r(p,{to:{path:"product",query:{id:o.product.id}}},{default:a(()=>[t("img",{src:o.product.imageUrl,alt:"",style:{width:"72px",height:"72px","object-fit":"cover"}},null,8,ot),t("p",st,n(o.product.title)+" "+n(o.product.unit),1)]),_:2},1032,["to"])]),t("td",et,[t("div",it,[t("div",nt,[t("button",{class:"btn btn-outline-dark border-0 py-1",type:"button",id:"button-addon1",onClick:l=>{o.qty--,s.updateCart(o,o.qty)}},at,8,dt)]),P(t("input",{type:"text",class:"form-control border-0 text-center my-auto shadow-none",placeholder:"","aria-label":"Example text with button addon","aria-describedby":"button-addon1","onUpdate:modelValue":l=>o.qty=l,readonly:""},null,8,ct),[[E,o.qty]]),t("div",rt,[t("button",{class:"btn btn-outline-dark border-0 py-1",type:"button",id:"button-addon2",onClick:l=>{o.qty++,s.updateCart(o,o.qty)}},_t,8,ut)])])]),t("td",ht,[t("p",bt,"NT$"+n((_=o.total)==null?void 0:_.toLocaleString()),1)]),t("td",mt,[t("i",{class:"bi bi-x",onClick:l=>s.deleteCart(o.id)},null,8,ft)])])}),128))])]),t("div",gt,[t("div",yt,[P(t("input",{type:"text",class:"form-control w-75 border-primary",placeholder:"輸入優惠券popovgo即享50%折價","aria-label":"Recipient's username","aria-describedby":"button-addon2","onUpdate:modelValue":d[0]||(d[0]=o=>c.couponCode=o)},null,512),[[E,c.couponCode]]),t("button",{class:"btn border-bottom border-top-0 border-start-0 border-end-0 btn-outline-primary rounded d-inline-block ms-1",type:"button",id:"button-addon2",onClick:d[1]||(d[1]=o=>B.postCoupon(c.couponCode)),disabled:c.couponCode===""},[t("i",{class:q({"bi bi-send-check-fill":c.couponCode!="","bi bi-send":c.couponCode===""})},null,2)],8,vt)]),t("div",Ct,[t("button",{class:"btn btn-outline-danger",type:"button",onClick:d[2]||(d[2]=o=>s.deleteCarts()),disabled:s.isCartsLoading}," 清空購物車 ",8,wt)])])]),t("div",kt,[t("div",xt,[Tt,t("div",Lt,[St,t("p",Vt,n(s.carts.carts.length),1)]),s.carts.final_total!=s.carts.total?(e(),i("div",Pt,[Et,t("p",qt,n(s.carts.final_total/s.carts.total*100)+" %",1)])):u("",!0),t("div",Ut,[$t,t("p",Nt,"NT$"+n((y=s.carts.final_total)==null?void 0:y.toLocaleString()),1)]),r(p,{to:"checkout",class:q(["btn btn-primary w-100 mt-4 fs-4",{disabled:!((C=(v=s.carts)==null?void 0:v.carts)!=null&&C.length)}])},{default:a(()=>[U("送出訂單")]),_:1},8,["class"])])])])):u("",!0),t("div",Bt,[It,t("div",jt,[(w=s.products)!=null&&w.products?u("",!0):(e(),i("img",At)),s.isCartsLoading?u("",!0):(e(),A(m,{key:1,active:s.isProductsLoading,"is-full-page":!1},{default:a(()=>[Ot]),_:1},8,["active"]))]),t("div",Rt,[(e(!0),i(S,null,V(s.products.products,o=>{var _,l;return e(),i("div",{class:"col-12 col-md-3 col-lg-2",key:o.id},[t("div",Dt,[r(p,{to:{path:"product",query:{id:o.id}}},{default:a(()=>[t("img",{src:o.imageUrl,class:"card-img-top object-fit-contain position-relative rounded border border-1 border-secondary",alt:"product.description",style:{width:"100%"}},null,8,Mt)]),_:2},1032,["to"]),t("div",Ft,[r(p,{to:{path:"product",query:{id:o.id}},style:{"text-decoration":"none"}},{default:a(()=>[t("h4",Ht,n(o.content)+" "+n(o.unit),1)]),_:2},1032,["to"]),t("p",zt,[U("NT$"+n((_=o.price)==null?void 0:_.toLocaleString())+" ",1),t("span",Kt,[o.price!=o.origin_price?(e(),i("del",Gt,"NT$"+n((l=o.origin_price)==null?void 0:l.toLocaleString()),1)):u("",!0)])]),Jt])])])}),128))])])])])}const oo=I(M,[["render",Qt]]);export{oo as default};
