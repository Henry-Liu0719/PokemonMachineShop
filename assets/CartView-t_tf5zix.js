import{_ as N,m as C,k as B,S as w,a as k,r as T,o as e,c as i,d as c,e as l,b as t,h as r,F as L,g as S,l as V,v as x,n as P,t as n,q as I,i as E}from"./index-c-tF3n3U.js";import{c as q}from"./cartStore-vYRPGnmh.js";import{p as U}from"./productStore-us0ThPRG.js";import{_ as h}from"./Animation - 1710557059960-SOXLnD8x.js";var j={VITE_URL:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"popovgo",VITE_POKEMON_API:"https://pokeapi.co/api/v2",BASE_URL:"/PokemonMachineShop/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:A,VITE_PATH:O}=j,R={data(){return{productId:"",num:1,couponCode:""}},mounted(){this.getCart(),this.getProducts()},methods:{...C(q,["getCart","deleteCart","updateCart","deleteCarts"]),...C(U,["openModal","addToCart","getProducts","filterType","getAllProducts"]),postCoupon(s){this.isUpdating=!0;const d={data:{code:`${s}`}};B.post(`${A}/api/${O}/coupon`,d).then(u=>{this.getCart(),w.fire({title:"使用優惠券成功",icon:"success",timer:1e3,showConfirmButton:!1,showCancelButton:!1})}).catch(u=>{w.fire({position:"top-end",icon:"error",title:`${u.response.data.message}`,showConfirmButton:!1,timer:1e3}),console.dir(u)}).finally(()=>{this.isUpdating=!1})}},computed:{...k(q,["carts","isCartsLoading"]),...k(U,["products","isProductsLoading","allProducts"])},watch:{num(){this.num=this.num<1?1:this.num}}},D={class:"container"},M=t("img",{src:h,alt:"讀取中",class:"img-fluid"},null,-1),F={class:"mt-3 fs-4"},H=t("h3",{class:"mt-3 mb-4 fs-1"},"購物車",-1),z={key:0,class:"p-0 container d-flex"},K=t("h4",{class:"my-auto"},"購物車無商品",-1),G=t("div",{class:"my-auto"},"前往產品列表",-1),J={key:1,class:"row"},Q={class:"col-md-8"},W={class:"table"},X=t("thead",null,[t("tr",null,[t("th",{scope:"col",class:"border-0 ps-0"},"品名"),t("th",{scope:"col",class:"border-0"},"數量"),t("th",{scope:"col",class:"border-0"},"小計"),t("th",{scope:"col",class:"border-0"})])],-1),Y={scope:"row",class:"border-0 px-0 font-weight-normal py-4"},Z=["src"],tt={class:"mb-0 fw-bold ms-3 d-inline-block"},ot={class:"border-0 align-middle",style:{"max-width":"160px"}},st={class:"input-group pe-5"},et={class:"input-group-prepend"},it=["onClick"],nt=t("i",{class:"bi bi-dash"},null,-1),dt=[nt],lt=["onUpdate:modelValue"],at={class:"input-group-append"},ct=["onClick"],rt=t("i",{class:"bi bi-plus"},null,-1),pt=[rt],ut={class:"border-0 align-middle"},_t={class:"mb-0 ms-auto"},ht={class:"border-0 align-middle"},bt=["onClick"],mt={class:"input-group mb-3 d-flex justify-content-between"},ft={class:"input-group-append d-flex flex-grow-1"},gt=["disabled"],yt={class:"text-end d-inline-block"},vt=["disabled"],Ct={class:"col-md-4"},wt={class:"border p-4 mb-4"},kt=t("h4",{class:"fw-bold mb-4"},"訂單詳情",-1),Tt={class:"d-flex justify-content-between mt-4"},Lt=t("p",{class:"mb-0 h4 fw-bold"},"商品數量",-1),St={class:"mb-0 h4 fw-bold"},Vt={key:0,class:"d-flex justify-content-between mt-4"},xt=t("p",{class:"mb-0 h4 fw-bold"},"優惠折扣",-1),Pt={class:"mb-0 h4 fw-bold"},Et={class:"d-flex justify-content-between mt-4"},qt=t("p",{class:"mb-0 h4 fw-bold"},"總額",-1),Ut={class:"mb-0 h4 fw-bold"},$t={class:"col-12"},Nt=t("h3",{class:"my-3"},"查看更多商品",-1),Bt={class:"vl-parent"},It={key:0,src:h,alt:"讀取中",class:"img-fluid opacity-0"},jt=t("img",{src:h,alt:"讀取中",class:"img-fluid"},null,-1),At={class:"row"},Ot={class:"card border-0 mb-4 position-relative position-relative"},Rt=["src"],Dt={class:"card-body p-0"},Mt={class:"mb-0 mt-3"},Ft={class:"card-text mb-0"},Ht={class:"text-muted"},zt={key:0},Kt=t("p",{class:"text-muted mt-3"},null,-1);function Gt(s,d,u,Jt,a,$){var m,f,g,y,v;const b=T("loadingOverlay"),p=T("router-link");return e(),i("div",D,[c(b,{active:s.isCartsLoading,"is-full-page":!0},{default:l(()=>[M]),_:1},8,["active"]),t("div",F,[H,(m=s.carts.carts)!=null&&m.length?r("",!0):(e(),i("div",z,[K,c(p,{class:"btn btn-danger rounded w-auto mx-2 mb-2",to:"products"},{default:l(()=>[G]),_:1})])),(f=s.carts.carts)!=null&&f.length?(e(),i("div",J,[t("div",Q,[t("table",W,[X,t("tbody",null,[(e(!0),i(L,null,S(s.carts.carts,o=>(e(),i("tr",{key:o.id,class:"border-bottom border-top"},[t("th",Y,[c(p,{to:{path:"product",query:{id:o.product.id}}},{default:l(()=>[t("img",{src:o.product.imageUrl,alt:"",style:{width:"72px",height:"72px","object-fit":"cover"}},null,8,Z),t("p",tt,n(o.product.title)+" "+n(o.product.unit),1)]),_:2},1032,["to"])]),t("td",ot,[t("div",st,[t("div",et,[t("button",{class:"btn btn-outline-dark border-0 py-2",type:"button",id:"button-addon1",onClick:_=>{o.qty--,s.updateCart(o,o.qty)}},dt,8,it)]),V(t("input",{type:"text",class:"form-control border-0 text-center my-auto shadow-none",placeholder:"","aria-label":"Example text with button addon","aria-describedby":"button-addon1","onUpdate:modelValue":_=>o.qty=_,readonly:""},null,8,lt),[[x,o.qty]]),t("div",at,[t("button",{class:"btn btn-outline-dark border-0 py-2",type:"button",id:"button-addon2",onClick:_=>{o.qty++,s.updateCart(o,o.qty)}},pt,8,ct)])])]),t("td",ut,[t("p",_t,"NT$"+n(o.total.toLocaleString()),1)]),t("td",ht,[t("i",{class:"bi bi-x",onClick:_=>s.deleteCart(o.id)},null,8,bt)])]))),128))])]),t("div",mt,[t("div",ft,[V(t("input",{type:"text",class:"form-control w-75 border-primary",placeholder:"輸入優惠券popovgo即享50%折價","aria-label":"Recipient's username","aria-describedby":"button-addon2","onUpdate:modelValue":d[0]||(d[0]=o=>a.couponCode=o)},null,512),[[x,a.couponCode]]),t("button",{class:"btn border-bottom border-top-0 border-start-0 border-end-0 btn-outline-primary rounded d-inline-block ms-1",type:"button",id:"button-addon2",onClick:d[1]||(d[1]=o=>$.postCoupon(a.couponCode)),disabled:a.couponCode===""},[t("i",{class:P({"bi bi-send-check-fill":a.couponCode!="","bi bi-send":a.couponCode===""})},null,2)],8,gt)]),t("div",yt,[t("button",{class:"btn btn-outline-danger",type:"button",onClick:d[2]||(d[2]=o=>s.deleteCarts()),disabled:s.isCartsLoading}," 清空購物車 ",8,vt)])])]),t("div",Ct,[t("div",wt,[kt,t("div",Tt,[Lt,t("p",St,n(s.carts.carts.length),1)]),s.carts.final_total!=s.carts.total?(e(),i("div",Vt,[xt,t("p",Pt,n(s.carts.final_total/s.carts.total*100)+" %",1)])):r("",!0),t("div",Et,[qt,t("p",Ut,"NT$"+n(s.carts.final_total.toLocaleString()),1)]),c(p,{to:"checkout",class:P(["btn btn-primary w-100 mt-4 fs-4",{disabled:!((y=(g=s.carts)==null?void 0:g.carts)!=null&&y.length)}])},{default:l(()=>[E("送出訂單")]),_:1},8,["class"])])])])):r("",!0),t("div",$t,[Nt,t("div",Bt,[(v=s.products)!=null&&v.products?r("",!0):(e(),i("img",It)),s.isCartsLoading?r("",!0):(e(),I(b,{key:1,active:s.isProductsLoading,"is-full-page":!1},{default:l(()=>[jt]),_:1},8,["active"]))]),t("div",At,[(e(!0),i(L,null,S(s.products.products,o=>(e(),i("div",{class:"col-12 col-md-3 col-lg-2",key:o.id},[t("div",Ot,[c(p,{to:{path:"product",query:{id:o.id}}},{default:l(()=>[t("img",{src:o.imageUrl,class:"card-img-top object-fit-contain position-relative rounded border border-1 border-secondary",alt:"product.description",style:{width:"100%"}},null,8,Rt)]),_:2},1032,["to"]),t("div",Dt,[c(p,{to:{path:"product",query:{id:o.id}},style:{"text-decoration":"none"}},{default:l(()=>[t("h4",Mt,n(o.content)+" "+n(o.unit),1)]),_:2},1032,["to"]),t("p",Ft,[E("NT$"+n(o.price.toLocaleString())+" ",1),t("span",Ht,[o.price!=o.origin_price?(e(),i("del",zt,"NT$"+n(o.origin_price.toLocaleString()),1)):r("",!0)])]),Kt])])]))),128))])])])])}const Zt=N(R,[["render",Gt]]);export{Zt as default};
