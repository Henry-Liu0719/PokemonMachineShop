import{_ as A,a as l,p as q,m as u,r as L,o as i,c as r,b as t,d as p,e as h,n,F as _,g,t as c,h as F,j as m,i as E}from"./index-5ozguhQ_.js";import{p as W}from"./productStore-QC_hXnGT.js";import{f as $}from"./favoriteStore-fUPOzZWC.js";import{c as V}from"./cartStore-YEFQY0Na.js";import{_ as j}from"./Animation - 1710557059960-SOXLnD8x.js";const U={data(){return{yOffset:0,filterdProducts:{},searchedProducts:{},typeSelected:"全部"}},components:{},mounted(){this.init(),this.yOffset=document.querySelector("div.container.mt-md-5.mt-3.mb-7 > div > div.col-8 > div > h4").getBoundingClientRect().top+window.pageYOffset},computed:{...l(W,["products","isProductsLoading","allProducts"]),...l(q,["typeNameList"]),...l($,["favorites"]),...l(V,["carts","isCartsLoading","isUpdating"])},watch:{async products(){this.filterdProducts={...this.products},this.$route.query.keyWord&&await this.getAllProducts()},allProducts(){this.filterdProducts={...this.allProducts},this.createSearchedProducts()}},methods:{...u(W,["openModal","addToCart","getProducts","filterType","getAllProducts"]),...u(q,["exportTypeNamesList"]),...u($,["addToFavorites","removeFromFavorites","getFavorites"]),...u(V,["getCart","addToCart","deleteCart"]),async init(){this.getCart();const s=this.$route.query.category||"";await this.getProducts(1,0,s),this.exportTypeNamesList()},filterType(s="岩石"){this.filterdProducts.products=this.products.products.filter(a=>a.unit===s),window.scrollTo({top:this.yOffset,behavior:"smooth"})},async createSearchedProducts(){const s=this.$route.query.keyWord;console.log("this.filterdProducts",this.filterdProducts),this.searchedProducts={success:!0,products:[],pagination:{total_pages:1,current_page:1,has_pre:!1,has_next:!1,category:""},messages:[]},this.searchedProducts.products=this.filterdProducts.products.filter(a=>a.description.includes(s)||a.unit.includes(s)||a.pokemons.some(y=>y.name===s)),console.log("this.searchedProducts",this.searchedProducts),this.filterdProducts={...this.searchedProducts}}}},M=t("div",{class:"container"},null,-1),z={class:"container mt-md-5 mt-3 mb-7 mx-1"},D=t("img",{src:j,alt:"讀取中",class:"img-fluid"},null,-1),R={class:"row"},Y={class:"col-4 col-md-3"},G={class:"accordion border border-bottom border-top-0 border-start-0 border-end-0 mb-3",id:"accordionExample"},H={class:"card border-0 mx-3"},I=t("div",{class:"card-header px-0 py-4 bg-white border-0",id:"headingOne","data-bs-toggle":"collapse","data-bs-target":"#collapseOne"},[t("div",{class:""},[t("h3",{class:"mb-0 text-center"}," 屬性瀏覽 ")])],-1),J={id:"collapseOne",class:"collapse show","aria-labelledby":"headingOne","data-bs-parent":"#accordionExample"},K={class:"py-0"},Q={class:"list-group"},X=["onClick"],Z={class:"col-8 col-md-9"},x={class:"row"},tt={class:"card border-0 mb-4 position-relative position-relative"},et=["src"],st=t("img",{src:j,alt:"讀取中",class:"img-fluid"},null,-1),ot=["onClick"],it=t("i",{class:"bi bi-heart"},null,-1),rt=t("span",{class:"visually-hidden"},"unread messages",-1),at=[it,rt],dt=["onClick"],nt=t("i",{class:"bi bi-heart"},null,-1),ct=t("span",{class:"visually-hidden"},"unread messages",-1),lt=[nt,ct],ut=["onClick"],pt=t("i",{class:"bi bi-cart"},null,-1),ht=t("span",{class:"visually-hidden"},"unread messages",-1),_t=[pt,ht],mt=["onClick"],gt=t("i",{class:"bi bi-cart"},null,-1),yt=t("span",{class:"visually-hidden"},"unread messages",-1),bt=[gt,yt],ft={class:"card-body p-0"},vt={class:"mb-0 mt-3"},kt={class:"card-text mb-0"},Pt={class:"text-muted"},Ct={key:0},wt=t("p",{class:"text-muted mt-3"},null,-1),Ot={key:0,class:"d-flex justify-content-center"},St={class:"pagination pagination-lg"},Tt={class:"page-item"},Nt=t("span",{"aria-hidden":"true"},"«",-1),qt=[Nt],Lt=["onClick"],Ft={class:"page-item"},Wt=t("span",{"aria-hidden":"true"},"»",-1),$t=[Wt];function Vt(s,a,y,jt,o,Bt){var v,k,P,C,w,O,S,T,N;const b=L("loadingOverlay"),f=L("router-link");return i(),r(_,null,[M,t("div",z,[p(b,{active:s.isProductsLoading,"is-full-page":!0},{default:h(()=>[D]),_:1},8,["active"]),t("div",R,[t("div",Y,[t("div",G,[t("div",H,[I,t("div",J,[t("div",K,[t("ul",Q,[t("button",{type:"button",href:"#",class:"page-link fs-5",onClick:a[0]||(a[0]=e=>{o.typeSelected="全部",this.$route.query.keyWord="",s.isLoading=!0,s.getProducts(1,o.yOffset,"")})},[t("li",{class:n(["list-group-item py-2 px-2",{active:o.typeSelected=="全部"}])}," 瀏覽全部 ",2)]),(i(!0),r(_,null,g(Object.entries(s.typeNameList),e=>(i(),r("button",{type:"button",href:"#",class:"page-link fs-5",key:e[0]},[t("li",{class:n(["list-group-item py-2 px-2",{active:o.typeSelected==e[0]}]),onClick:d=>{this.typeSelected=e[0],this.$route.query.keyWord="",s.isLoading=!0,s.getProducts(1,o.yOffset,e[1])}},c(e[1]),11,X)]))),128))])])])])])]),t("div",Z,[t("div",x,[t("h4",{class:n(["opacity-0 mt-6",{"opacity-100":!((v=o.filterdProducts.products)!=null&&v.length)}])},"無相符的查詢結果",2),t("h4",{class:n(["opacity-0 mt-6",{"opacity-100":(k=s.$route.query.keyWord)==null?void 0:k.length}])},"「"+c(s.$route.query.keyWord)+"」的招式機配對結果",3),(i(!0),r(_,null,g(o.filterdProducts.products,e=>(i(),r("div",{class:"col-12 col-md-4 col-lg-3",key:e.id},[t("div",tt,[p(f,{to:{path:"product",query:{id:e.id}},class:"vl-parent"},{default:h(()=>[t("img",{src:e.imageUrl,class:"card-img-top object-fit-contain position-relative rounded border border-1 border-secondary",alt:"product.description",style:{width:"100%"}},null,8,et),p(b,{active:s.isUpdating,"is-full-page":!1},{default:h(()=>[st]),_:1},8,["active"])]),_:2},1032,["to"]),t("span",null,[s.favorites.some(d=>d.id===e.id)?(i(),r("button",{key:1,type:"button",class:"position-absolute top-0 start-0 badge bg-primary border-0",style:{width:"3rem",height:"1.5rem","border-radius":"0.375rem 0"},onClick:m(d=>s.removeFromFavorites(e.id),["prevent"])},lt,8,dt)):(i(),r("button",{key:0,type:"button",class:"position-absolute top-0 start-0 badge bg-secondary border-0",style:{width:"3rem",height:"1.5rem","border-radius":"0.375rem 0"},onClick:m(d=>s.addToFavorites(e),["prevent"])},at,8,ot))]),t("span",null,[s.carts.carts.some(d=>d.product.id===e.id)?(i(),r("button",{key:1,type:"button",class:"position-absolute top-0 start-100 badge bg-primary border-0",style:{transform:"translate(-100%, 0)",width:"3rem",height:"1.5rem","border-radius":"0 0.375rem"},onClick:m(d=>s.deleteCart(s.carts.carts.filter(B=>B.product_id==e.id)[0].id),["prevent"])},bt,8,mt)):(i(),r("button",{key:0,type:"button",class:"position-absolute top-0 start-100 badge bg-secondary border-0",style:{transform:"translate(-100%, 0)",width:"3rem",height:"1.5rem","border-radius":"0 0.375rem"},onClick:m(d=>s.addToCart(e.id,1),["prevent"])},_t,8,ut))]),t("div",ft,[p(f,{to:{path:"product",query:{id:e.id}},style:{"text-decoration":"none"}},{default:h(()=>[t("h4",vt,c(e.content)+" "+c(e.unit),1)]),_:2},1032,["to"]),t("p",kt,[E("NT$"+c(e.price)+" ",1),t("span",Pt,[e.price!=e.origin_price?(i(),r("del",Ct,"NT$"+c(e.origin_price),1)):F("",!0)])]),wt])])]))),128))]),!((C=(P=o.filterdProducts)==null?void 0:P.products)!=null&&C.length)==0?(i(),r("nav",Ot,[t("ul",St,[t("li",Tt,[t("button",{type:"button",class:n(["page-link",{disabled:!((O=(w=o.filterdProducts)==null?void 0:w.pagination)!=null&&O.has_pre)}]),"aria-label":"Previous",onClick:a[1]||(a[1]=e=>s.getProducts(s.products.pagination.current_page-1,o.yOffset))},qt,2)]),(i(!0),r(_,null,g((S=o.filterdProducts.pagination)==null?void 0:S.total_pages,e=>(i(),r("li",{class:n(["page-item",{active:o.filterdProducts.pagination.current_page==e}]),key:e},[t("button",{class:"page-link",onClick:d=>s.getProducts(e,o.yOffset)},c(e),9,Lt)],2))),128)),t("li",Ft,[t("button",{type:"button",class:n(["page-link",{disabled:!((N=(T=o.filterdProducts)==null?void 0:T.pagination)!=null&&N.has_next)}]),"aria-label":"Next",onClick:a[2]||(a[2]=e=>s.getProducts(s.products.pagination.current_page+1,o.yOffset))},$t,2)])])])):F("",!0)])])])],64)}const Dt=A(U,[["render",Vt]]);export{Dt as default};
