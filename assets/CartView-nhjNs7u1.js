import{_ as j,m as L,l as I,S as T,a as x,r as S,o as e,c as l,d as c,e as n,b as t,h as r,F as V,g as P,q as E,v as $,j as q,t as i,s as M,i as N}from"./index-_rV0SiY7.js";import{c as U}from"./cartStore-rhnC-t0x.js";import{p as B}from"./productStore-9G8Oa4kQ.js";import{_ as m}from"./Animation - 1710557059960-SOXLnD8x.js";var A={VITE_URL:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"popovgo",VITE_POKEMON_API:"https://pokeapi.co/api/v2",BASE_URL:"/PokemonMachineShop/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:O,VITE_PATH:D}=A,F={data(){return{productId:"",num:1,couponCode:""}},mounted(){this.getCart(),this.getProducts()},methods:{...L(U,["getCart","deleteCart","updateCart","deleteCarts"]),...L(B,["openModal","addToCart","getProducts","filterType","getAllProducts"]),postCoupon(s){this.isUpdating=!0;const d={data:{code:`${s}`}};I.post(`${O}/api/${D}/coupon`,d).then(h=>{this.getCart(),T.fire({title:"使用優惠券成功",icon:"success",timer:1e3,showConfirmButton:!1,showCancelButton:!1})}).catch(h=>{T.fire({position:"top-end",icon:"error",title:`${h.response.data.message}`,showConfirmButton:!1,timer:1e3}),console.dir(h)}).finally(()=>{this.isUpdating=!1})}},computed:{...x(U,["carts","isCartsLoading"]),...x(B,["products","isProductsLoading","allProducts"])},watch:{num(){this.num=this.num<1?1:this.num}}},H={class:"container"},z=t("img",{src:m,alt:"讀取中",class:"img-fluid"},null,-1),K={class:"mt-3 fs-4"},G=t("h3",{class:"mt-3 mb-4 fs-1"},"購物車",-1),J={key:0,class:"p-0 container d-flex"},Q=t("h4",{class:"my-auto"},"購物車無商品",-1),W=t("div",{class:"my-auto"},"前往產品列表",-1),X={key:1,class:"row"},Y={class:"col-12 col-xl-9"},Z={class:"table"},tt=t("thead",null,[t("tr",null,[t("th",{scope:"col",class:"border-0 bg-light ps-0 col-4 col-xl-5"},"品名"),t("th",{scope:"col",class:"border-0 bg-light"},"數量"),t("th",{scope:"col",class:"border-0 bg-light col-3 col-lg-2"},"單價"),t("th",{scope:"col",class:"border-0 bg-light col-3 col-lg-2"},"小計"),t("th",{scope:"col",class:"border-0 bg-light col-1"})])],-1),ot={scope:"row",class:"border-0 bg-light px-0 font-weight-normal py-4"},st=["src"],et={class:"mb-0 fw-bold ms-3 d-inline-block"},it={class:"border-0 bg-light align-middle",style:{"max-width":"160px"}},lt={class:"input-group"},dt={class:"input-group-prepend"},nt=["onClick"],at=t("i",{class:"bi bi-dash"},null,-1),ct=[at],rt=["onUpdate:modelValue"],ut={class:"input-group-append"},pt=["onClick"],_t=t("i",{class:"bi bi-plus"},null,-1),ht=[_t],bt={class:"border-0 bg-light align-middle"},mt={class:"mb-0 ms-auto"},gt={class:"border-0 bg-light align-middle"},ft={class:"mb-0 ms-auto"},yt={class:"border-0 bg-light align-middle"},vt=["onClick"],Ct={class:"input-group mb-3 d-flex justify-content-between"},wt={class:"input-group-append d-flex flex-grow-1"},kt=["disabled"],Lt={class:"text-end d-inline-block"},Tt=["disabled"],xt={class:"col-xl-3"},St={class:"border p-4 mb-4"},Vt=t("h4",{class:"fw-bold mb-4"},"訂單詳情",-1),Pt={class:"d-flex justify-content-between mt-4"},Et=t("p",{class:"mb-0 h4 fw-bold"},"商品數量",-1),$t={class:"mb-0 h4 fw-bold"},qt={key:0,class:"d-flex justify-content-between mt-4"},Nt=t("p",{class:"mb-0 h4 fw-bold"},"優惠折扣",-1),Ut={class:"mb-0 h4 fw-bold"},Bt={class:"d-flex justify-content-between mt-4"},Rt=t("p",{class:"mb-0 h4 fw-bold"},"總額",-1),jt={class:"mb-0 h4 fw-bold"},It={class:"col-12"},Mt=t("h3",{class:"my-3"},"查看更多商品",-1),At={class:"vl-parent"},Ot={key:0,src:m,alt:"讀取中",class:"img-fluid opacity-0"},Dt=t("img",{src:m,alt:"讀取中",class:"img-fluid"},null,-1),Ft={class:"row"},Ht={class:"card border-0 mb-4 position-relative position-relative"},zt=["src"],Kt={class:"card-body p-0 bg-light"},Gt={class:"mb-0 mt-3"},Jt={class:"card-text mb-0"},Qt={class:"text-muted"},Wt={key:0},Xt=t("p",{class:"text-muted mt-3"},null,-1);function Yt(s,d,h,Zt,a,R){var f,y,v,C,w,k;const g=S("loadingOverlay"),u=S("RouterLink");return e(),l("div",H,[c(g,{active:s.isCartsLoading,"is-full-page":!0},{default:n(()=>[z]),_:1},8,["active"]),t("div",K,[G,(f=s.carts.carts)!=null&&f.length?r("",!0):(e(),l("div",J,[Q,c(u,{class:"btn btn-danger rounded w-auto mx-2 mb-2",to:"products"},{default:n(()=>[W]),_:1})])),(y=s.carts.carts)!=null&&y.length?(e(),l("div",X,[t("div",Y,[t("table",Z,[tt,t("tbody",null,[(e(!0),l(V,null,P(s.carts.carts,o=>{var p,_;return e(),l("tr",{key:o.id,class:"border-bottom border-top"},[t("th",ot,[c(u,{to:{path:"product",query:{id:o.product.id}}},{default:n(()=>[t("img",{src:o.product.imageUrl,alt:"",style:{width:"72px",height:"72px","object-fit":"cover"}},null,8,st),t("p",et,i(o.product.title)+" "+i(o.product.unit),1)]),_:2},1032,["to"])]),t("td",it,[t("div",lt,[t("div",dt,[t("button",{class:"btn btn-outline-dark border-0",type:"button",id:"button-addon1",onClick:b=>{o.qty--,s.updateCart(o,o.qty)}},ct,8,nt)]),E(t("input",{type:"text",class:"form-control border-0 text-center my-auto shadow-none bg-light",placeholder:"","aria-label":"Example text with button addon","aria-describedby":"button-addon1","onUpdate:modelValue":b=>o.qty=b,readonly:""},null,8,rt),[[$,o.qty]]),t("div",ut,[t("button",{class:"btn btn-outline-dark border-0",type:"button",id:"button-addon2",onClick:b=>{o.qty++,s.updateCart(o,o.qty)}},ht,8,pt)])])]),t("td",bt,[t("p",mt,"NT$"+i((p=o.product.price)==null?void 0:p.toLocaleString()),1)]),t("td",gt,[t("p",ft,"NT$"+i((_=o.total)==null?void 0:_.toLocaleString()),1)]),t("td",yt,[t("i",{class:"bi bi-x",onClick:b=>s.deleteCart(o.id)},null,8,vt)])])}),128))])]),t("div",Ct,[t("div",wt,[E(t("input",{type:"text",class:"form-control w-75 border-primary",placeholder:"輸入優惠券popovgo即享50%折價","aria-label":"Recipient's username","aria-describedby":"button-addon2","onUpdate:modelValue":d[0]||(d[0]=o=>a.couponCode=o)},null,512),[[$,a.couponCode]]),t("button",{class:"btn border-bottom border-top-0 border-start-0 border-end-0 btn-outline-primary rounded d-inline-block ms-1",type:"button",id:"button-addon2",onClick:d[1]||(d[1]=o=>R.postCoupon(a.couponCode)),disabled:a.couponCode===""},[t("i",{class:q({"bi bi-send-check-fill":a.couponCode!="","bi bi-send":a.couponCode===""})},null,2)],8,kt)]),t("div",Lt,[t("button",{class:"btn btn-outline-danger",type:"button",onClick:d[2]||(d[2]=o=>s.deleteCarts()),disabled:s.isCartsLoading}," 清空購物車 ",8,Tt)])])]),t("div",xt,[t("div",St,[Vt,t("div",Pt,[Et,t("p",$t,i(s.carts.carts.length),1)]),s.carts.final_total!=s.carts.total?(e(),l("div",qt,[Nt,t("p",Ut,i(Math.floor(s.carts.final_total/s.carts.total*100))+" %",1)])):r("",!0),t("div",Bt,[Rt,t("p",jt,"NT$"+i((v=Math.floor(s.carts.final_total))==null?void 0:v.toLocaleString()),1)]),c(u,{to:"checkout",class:q(["btn btn-primary w-100 mt-4 fs-4",{disabled:!((w=(C=s.carts)==null?void 0:C.carts)!=null&&w.length)}])},{default:n(()=>[N("送出訂單")]),_:1},8,["class"])])])])):r("",!0),t("div",It,[Mt,t("div",At,[(k=s.products)!=null&&k.products?r("",!0):(e(),l("img",Ot)),s.isCartsLoading?r("",!0):(e(),M(g,{key:1,active:s.isProductsLoading,"is-full-page":!1},{default:n(()=>[Dt]),_:1},8,["active"]))]),t("div",Ft,[(e(!0),l(V,null,P(s.products.products,o=>{var p,_;return e(),l("div",{class:"col-12 col-md-3 col-lg-2",key:o.id},[t("div",Ht,[c(u,{to:{path:"product",query:{id:o.id}}},{default:n(()=>[t("img",{src:o.imageUrl,class:"card-img-top object-fit-contain position-relative rounded border border-1 border-secondary",alt:"product.description",style:{width:"100%"}},null,8,zt)]),_:2},1032,["to"]),t("div",Kt,[c(u,{to:{path:"product",query:{id:o.id}},style:{"text-decoration":"none"}},{default:n(()=>[t("h4",Gt,i(o.content)+" "+i(o.unit),1)]),_:2},1032,["to"]),t("p",Jt,[N("NT$"+i((p=o.price)==null?void 0:p.toLocaleString())+" ",1),t("span",Qt,[o.price!=o.origin_price?(e(),l("del",Wt,"NT$"+i((_=o.origin_price)==null?void 0:_.toLocaleString()),1)):r("",!0)])]),Xt])])])}),128))])])])])}const io=j(F,[["render",Yt]]);export{io as default};
