import{a as V}from"./axios-G2rPRu76.js";import{_ as C,f as y,S as i,m as k,r as p,o as b,c as h,a as e,F as D,g as T,t as c,b as l,w as v,d as B,n as _,i as P,v as E,e as N}from"./index-nsHCg3Zr.js";import{c as x}from"./cartStore-phI7bO6e.js";var S={VITE_URL:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"gopopov",VITE_POKEMON_API:"https://pokeapi.co/api/v2",BASE_URL:"/PokemonMachineShop/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:I,VITE_PATH:j}=S,M={data(){return{orderData:{data:{user:{name:"testName",email:"test@gmail.com",tel:"0912346768",address:"Kaohsiung"},message:"這是留言"}}}},mounted(){this.getCart()},methods:{...y(x,["getCart"]),getOrder(){},isPhone(o){return/^(09)[0-9]{8}$/.test(o)?!0:"需要正確的電話號碼"},postOrder(){const o={...this.orderData},t=i.mixin({customClass:{confirmButton:"btn btn-success",cancelButton:"btn btn-danger"},buttonsStyling:!1});t.fire({title:`請確認以下資訊
Email：${o.data.user.email}
姓名：${o.data.user.name}
電話：${o.data.user.tel}
地址：${o.data.user.address}`,text:"點擊送出後將完成交易",icon:"warning",showCancelButton:!0,confirmButtonText:"完成交易",cancelButtonText:"回到結帳頁面",reverseButtons:!0}).then(f=>{f.isConfirmed?V.post(`${I}/api/${j}/order`,o).then(r=>{let s;i.fire({title:`${r.data.message}
訂單編號：${r.data.orderId}`,html:"<b></b>秒後回到產品列表",timer:3e3,timerProgressBar:!0,didOpen:()=>{i.showLoading();const d=i.getPopup().querySelector("b");s=setInterval(()=>{d.textContent=`${Math.ceil(i.getTimerLeft()/1e3)}`},100)},willClose:()=>{clearInterval(s)}}).then(d=>{d.dismiss,i.DismissReason.timer}).then(()=>{this.$router.push("/products")})}).catch(r=>{console.dir(r),i.fire({position:"top-end",icon:"false",title:"送出訂單失敗，請聯繫管理員",showConfirmButton:!1,timer:1e3})}):f.dismiss===i.DismissReason.cancel&&t.fire({title:"訂單資料未送出",icon:"warning"})})}},computed:{...k(x,["carts"])},watch:{}},U={class:"container"},O=B('<div class="row justify-content-center"><div class="col-md-10"><nav class="navbar navbar-expand-lg navbar-light px-0"><ul class="list-unstyled mb-0 ms-md-auto d-flex align-items-center justify-content-between justify-content-md-end w-100 mt-md-0 mt-4"><li class="me-md-6 me-3 position-relative custom-step-line"><i class="bi bi-check-circle d-md-inline d-block text-center"></i> <span class="text-nowrap">瀏覽產品</span></li><li class="me-md-6 me-3 position-relative custom-step-line"><i class="bi bi-check-circle d-md-inline d-block text-center"></i> <span class="text-nowrap">加入購物車</span></li><li><i class="bi bi-dot d-md-inline d-block text-center"></i> <span class="text-nowrap">送出訂單</span></li></ul></nav></div></div><div class="row justify-content-center"><div class="col-md-10"><h3 class="fw-bold mb-4 pt-3">填寫資料</h3></div></div>',2),R={class:"row flex-row-reverse justify-content-center pb-5"},A={class:"col-md-4"},L={class:"border p-4 mb-4"},$=["src"],q={class:"w-100"},H={class:"d-flex justify-content-between"},F={class:"mb-0 fw-bold"},K={class:"mb-0"},z={class:"mb-0 fw-bold"},W={class:"d-flex justify-content-between mt-4"},G=e("p",{class:"mb-0 h4 fw-bold"},"Total",-1),J={class:"mb-0 h4 fw-bold"},Q={class:"col-md-6"},X=e("p",null,"聯絡資訊",-1),Y={class:"mb-0"},Z=e("label",{for:"ContactMail",class:"text-muted mb-0 form-label"},"Email",-1),ee=e("p",{class:"mt-4"},"送件資訊",-1),te={class:"mb-2"},se=e("label",{for:"ContactName",class:"text-muted mb-0"},"姓名",-1),ae={class:"mb-2"},oe=e("label",{for:"ContactPhone",class:"text-muted mb-0"},"電話",-1),le={class:"mb-3"},ne=e("label",{for:"address",class:"form-label"},"收件人地址",-1),ie={class:"mb-2"},de=e("label",{for:"ContactMessage",class:"text-muted mb-0"},"備註",-1),re={class:"d-flex flex-column-reverse flex-md-row mt-4 justify-content-between align-items-md-center align-items-end w-100"},ce=e("i",{class:"fas fa-chevron-left me-2"},null,-1);function me(o,t,f,r,s,d){const m=p("v-field"),u=p("error-message"),g=p("v-form"),w=p("router-link");return b(),h("div",U,[O,e("div",R,[e("div",A,[e("div",L,[(b(!0),h(D,null,T(o.carts.carts,a=>(b(),h("div",{class:"d-flex",key:a.id},[e("img",{src:a.product.imageUrl,alt:"",class:"me-2",style:{width:"48px",height:"48px","object-fit":"cover"}},null,8,$),e("div",q,[e("div",H,[e("p",F,c(a.product.title)+" "+c(a.product.unit),1),e("p",K,"NT$"+c(a.total),1)]),e("p",z,"x"+c(a.qty),1)])]))),128)),e("div",W,[G,e("p",J,"NT$"+c(o.carts.total),1)])])]),e("div",Q,[l(g,null,{default:v(({errors:a})=>[X,e("div",Y,[Z,l(m,{type:"email",class:_(["form-control",{"is-invalid":a.email}]),id:"ContactMail","aria-describedby":"emailHelp",placeholder:"example@gmail.com",name:"email",rules:"email|required",modelValue:s.orderData.data.user.email,"onUpdate:modelValue":t[0]||(t[0]=n=>s.orderData.data.user.email=n)},null,8,["class","modelValue"]),l(u,{name:"email",class:"invalid-feedback"})]),ee,e("div",te,[se,l(m,{type:"text",class:_(["form-control",{"is-invalid":a.姓名}]),id:"ContactName",placeholder:"Carmen A. Rose",name:"姓名",rules:"required",modelValue:s.orderData.data.user.name,"onUpdate:modelValue":t[1]||(t[1]=n=>s.orderData.data.user.name=n)},null,8,["class","modelValue"]),l(u,{name:"姓名",class:"invalid-feedback"})]),e("div",ae,[oe,l(m,{type:"tel",class:_(["form-control",{"is-invalid":a.電話}]),id:"ContactPhone",placeholder:"ContactPhone",name:"電話",rules:d.isPhone,modelValue:s.orderData.data.user.tel,"onUpdate:modelValue":t[2]||(t[2]=n=>s.orderData.data.user.tel=n)},null,8,["class","rules","modelValue"]),l(u,{name:"電話",class:"invalid-feedback"})]),e("div",le,[ne,l(m,{id:"address",name:"地址",type:"text",class:_(["form-control",{"is-invalid":a.地址}]),placeholder:"請輸入地址",rules:"required",modelValue:s.orderData.data.user.address,"onUpdate:modelValue":t[3]||(t[3]=n=>s.orderData.data.user.address=n)},null,8,["class","modelValue"]),l(u,{name:"地址",class:"invalid-feedback"})]),e("div",ie,[de,P(e("textarea",{class:"form-control",rows:"3",id:"ContactMessage",placeholder:"message ... ","onUpdate:modelValue":t[4]||(t[4]=n=>s.orderData.data.message=n)},null,512),[[E,s.orderData.data.message]])])]),_:1}),e("div",re,[l(w,{to:"products",class:"text-dark mt-md-0 mt-3"},{default:v(()=>[ce,N(" 回到產品頁")]),_:1}),e("button",{class:"btn btn-dark py-3 px-7",onClick:t[5]||(t[5]=a=>d.postOrder())},"完成訂單")])])])])}const fe=C(M,[["render",me]]);export{fe as default};
