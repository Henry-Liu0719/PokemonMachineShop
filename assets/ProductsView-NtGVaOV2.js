import{_ as R,a as u,p as $,m as p,r as V,o as i,c as r,d as h,e as g,b as t,j as n,F as m,g as y,h as b,t as l,i as E,k as _}from"./index-_rV0SiY7.js";import{p as j}from"./productStore-9G8Oa4kQ.js";import{f as A}from"./favoriteStore-i-vlCWUQ.js";import{c as B}from"./cartStore-rhnC-t0x.js";import{_ as U}from"./Animation - 1710557059960-SOXLnD8x.js";const z={data(){return{yOffset:0,filterdProducts:{},searchedProducts:{},typeSelected:"全部"}},components:{},mounted(){this.init()},computed:{...u(j,["products","isProductsLoading","allProducts"]),...u($,["typeNameList"]),...u(A,["favorites"]),...u(B,["carts","isCartsLoading","isUpdating"])},watch:{async products(){this.filterdProducts={...this.products},this.$route.query.keyWord&&await this.getAllProducts()},allProducts(){this.filterdProducts={...this.allProducts},this.createSearchedProducts()}},methods:{...p(j,["openModal","addToCart","getProducts","filterType","getAllProducts"]),...p($,["exportTypeNamesList"]),...p(A,["addToFavorites","removeFromFavorites","getFavorites"]),...p(B,["getCart","addToCart","deleteCart"]),async init(){this.getCart();const e=this.$route.query.category||"";e!==""&&(this.typeSelected=e),console.log(this.typeSelected),await this.getProducts(1,0,e),this.exportTypeNamesList()},filterType(e="岩石"){this.filterdProducts.products=this.products.products.filter(a=>a.unit===e),window.scrollTo({top:this.yOffset,behavior:"smooth"})},async createSearchedProducts(){const e=this.$route.query.keyWord;this.searchedProducts={success:!0,products:[],pagination:{total_pages:1,current_page:1,has_pre:!1,has_next:!1,category:""},messages:[]},this.searchedProducts.products=this.filterdProducts.products.filter(a=>a.description.includes(e)||a.unit.includes(e)||a.pokemons.some(f=>f.name===e)),this.filterdProducts={...this.searchedProducts}}}},D={class:"container"},G=t("img",{src:U,alt:"讀取中",class:"img-fluid"},null,-1),H={class:"row"},I={class:"col-12 col-sm-4 col-md-3 order-last order-sm-first"},J={class:"accordion border border-bottom border-top-0 border-start-0 border-end-0 mb-3",id:"accordionExample"},K={class:"card border-0 mx-3"},Q=t("div",{class:"card-header px-0 py-4 bg-light border-0",id:"headingOne","data-bs-toggle":"collapse","data-bs-target":"#collapseOne"},[t("div",null,[t("h3",{class:"mb-0 text-center"},[E(" 屬性瀏覽 "),t("i",{class:"bi bi-chevron-down"})])])],-1),X={id:"collapseOne",class:"collapse show","aria-labelledby":"headingOne","data-bs-parent":"#accordionExample"},Y={class:"py-0"},Z={class:"list-group"},x=["onClick"],tt={class:"col-12 col-sm-8 col-md-9"},et={class:"row"},st={class:"card border-0 mb-4 position-relative position-relative"},ot=["src"],it=t("img",{src:U,alt:"讀取中",class:"img-fluid"},null,-1),rt=["onClick"],at=t("i",{class:"bi bi-heart"},null,-1),dt=t("span",{class:"visually-hidden"},"unread messages",-1),nt=[at,dt],lt=["onClick"],ct=t("i",{class:"bi bi-heart"},null,-1),ut=t("span",{class:"visually-hidden"},"unread messages",-1),pt=[ct,ut],ht=["onClick"],gt=t("i",{class:"bi bi-cart"},null,-1),_t=t("span",{class:"visually-hidden"},"unread messages",-1),mt=[gt,_t],yt=["onClick"],bt=t("i",{class:"bi bi-cart"},null,-1),ft=t("span",{class:"visually-hidden"},"unread messages",-1),vt=[bt,ft],kt={class:"card-body p-0 bg-light"},Pt={class:"mb-0 mt-3"},Ct={class:"card-text mb-0"},wt={class:"text-muted"},St={key:0},Lt=t("p",{class:"text-muted mt-3"},null,-1),Ot={key:0,class:"d-flex justify-content-center"},Tt={class:"pagination pagination"},Nt={class:"page-item"},qt=t("span",{"aria-hidden":"true"},"«",-1),Ft=[qt],Wt=["onClick"],$t={class:"page-item"},Vt=t("span",{"aria-hidden":"true"},"»",-1),jt=[Vt];function At(e,a,f,Bt,o,Et){var P,C,w,S,L,O,T,N,q,F;const v=V("loadingOverlay"),k=V("RouterLink");return i(),r("div",D,[h(v,{active:e.isProductsLoading,"is-full-page":!0},{default:g(()=>[G]),_:1},8,["active"]),t("div",H,[t("div",I,[t("div",J,[t("div",K,[Q,t("div",X,[t("div",Y,[t("ul",Z,[t("button",{type:"button",href:"#",class:"page-link fs-5",onClick:a[0]||(a[0]=s=>{o.typeSelected="全部",this.$route.query.keyWord="",e.isLoading=!0,e.getProducts(1,o.yOffset,"")})},[t("li",{class:n(["list-group-item py-2 px-2 bg-",o.typeSelected=="全部"?"active":"bg-light"])}," 瀏覽全部 ",2)]),(i(!0),r(m,null,y(Object.entries(e.typeNameList),s=>(i(),r("button",{type:"button",href:"#",class:"page-link fs-5",key:s[0]},[t("li",{class:n(["list-group-item py-2 px-2",o.typeSelected==s[1]?"active":"bg-light"]),onClick:c=>{this.typeSelected=s[1],this.$route.query.keyWord="",e.isLoading=!0,e.getProducts(1,o.yOffset,s[1])}},l(s[1]),11,x)]))),128))])])])])])]),t("div",tt,[t("div",et,[!((P=o.filterdProducts.products)!=null&&P.length)&&!e.isProductsLoading?(i(),r("h4",{key:0,class:n(["opacity-0 mt-6",{"opacity-100":!((C=o.filterdProducts.products)!=null&&C.length)&&!e.isProductsLoading}])},"無相符的查詢結果",2)):b("",!0),t("h4",{class:n(["opacity-0 mt-6",{"opacity-100":(w=e.$route.query.keyWord)==null?void 0:w.length}])},"「"+l(e.$route.query.keyWord)+"」的招式機配對結果",3),(i(!0),r(m,null,y(o.filterdProducts.products,s=>{var c,W;return i(),r("div",{class:"col-6 col-md-4 col-lg-3",key:s.id},[t("div",st,[h(k,{to:{path:"product",query:{id:s.id}},class:"vl-parent"},{default:g(()=>[t("img",{src:s.imageUrl,class:"card-img-top object-fit-contain position-relative rounded border border-1 border-secondary",alt:"product.description",style:{width:"100%"}},null,8,ot),h(v,{active:e.isUpdating,"is-full-page":!1},{default:g(()=>[it]),_:1},8,["active"])]),_:2},1032,["to"]),t("span",null,[e.favorites.some(d=>d.id===s.id)?(i(),r("button",{key:1,type:"button",class:"position-absolute top-0 start-0 badge bg-primary border-0",style:{width:"3rem",height:"1.5rem","border-radius":"0.375rem 0"},onClick:_(d=>e.removeFromFavorites(s.id),["prevent"])},pt,8,lt)):(i(),r("button",{key:0,type:"button",class:"position-absolute top-0 start-0 badge bg-secondary border-0",style:{width:"3rem",height:"1.5rem","border-radius":"0.375rem 0"},onClick:_(d=>e.addToFavorites(s),["prevent"])},nt,8,rt))]),t("span",null,[e.carts.carts.some(d=>d.product.id===s.id)?(i(),r("button",{key:1,type:"button",class:"position-absolute top-0 start-100 badge bg-primary border-0",style:{transform:"translate(-100%, 0)",width:"3rem",height:"1.5rem","border-radius":"0 0.375rem"},onClick:_(d=>e.deleteCart(e.carts.carts.filter(M=>M.product_id==s.id)[0].id),["prevent"])},vt,8,yt)):(i(),r("button",{key:0,type:"button",class:"position-absolute top-0 start-100 badge bg-secondary border-0",style:{transform:"translate(-100%, 0)",width:"3rem",height:"1.5rem","border-radius":"0 0.375rem"},onClick:_(d=>e.addToCart(s.id,1),["prevent"])},mt,8,ht))]),t("div",kt,[h(k,{to:{path:"product",query:{id:s.id}},style:{"text-decoration":"none"}},{default:g(()=>[t("h4",Pt,l(s.content)+" "+l(s.unit),1)]),_:2},1032,["to"]),t("p",Ct,[E("NT$"+l((c=s.price)==null?void 0:c.toLocaleString())+" ",1),t("span",wt,[s.price!=s.origin_price?(i(),r("del",St,"NT$"+l((W=s.origin_price)==null?void 0:W.toLocaleString()),1)):b("",!0)])]),Lt])])])}),128))]),!((L=(S=o.filterdProducts)==null?void 0:S.products)!=null&&L.length)==0?(i(),r("nav",Ot,[t("ul",Tt,[t("li",Nt,[t("button",{type:"button",class:n(["page-link",{disabled:!((T=(O=o.filterdProducts)==null?void 0:O.pagination)!=null&&T.has_pre)}]),"aria-label":"Previous",onClick:a[1]||(a[1]=s=>e.getProducts(e.products.pagination.current_page-1,o.yOffset))},Ft,2)]),(i(!0),r(m,null,y((N=o.filterdProducts.pagination)==null?void 0:N.total_pages,s=>(i(),r("li",{class:n(["page-item",{active:o.filterdProducts.pagination.current_page==s}]),key:s},[t("button",{class:"page-link",onClick:c=>e.getProducts(s,o.yOffset)},l(s),9,Wt)],2))),128)),t("li",$t,[t("button",{type:"button",class:n(["page-link",{disabled:!((F=(q=o.filterdProducts)==null?void 0:q.pagination)!=null&&F.has_next)}]),"aria-label":"Next",onClick:a[2]||(a[2]=s=>e.getProducts(e.products.pagination.current_page+1,o.yOffset))},jt,2)])])])):b("",!0)])])])}const Gt=R(z,[["render",At]]);export{Gt as default};
