import{a as r}from"./axios-G2rPRu76.js";import{p as c,S as n}from"./index-AlI_uR_g.js";var h={VITE_URL:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"gopokemon",VITE_POKEMON_API:"https://pokeapi.co/api/v2",BASE_URL:"/PokemonMachineShop/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_POKEMON_API:o}=h,p=c("pokemon",{state:()=>({summarizedProductList:[],productList:[],products:[],machines:[],machineList:[],moveUrlList:[],moveList:[],typeUrlList:[],typeList:[],typeNameList:{},isAttributesLoading:!0,isPokemonsLoading:!0,pokemons:{},speciesUrlList:[],speciesList:[],speciesNameList:{},pokemonCount:1025,typeColorList:{}}),actions:{async pokemonsView(){await this.createSpeciesUrlList(),await this.getSpeciesList(),this.getSpeciesNamesList(),await this.getPokemons()},async summarizeProductList(){await this.getMachines(),await this.getMachineList(),this.createSummarizedProductList(),this.addMachineName(),this.addCost(),this.addId(),this.addMachinePhoto(),await this.getMoveUrlList(),await this.getMoveList(),this.addMoveName(),this.addMoveText(),await this.createTypeUrlList(),await this.getTypeList(),this.getTypeNamesList(),this.addMoveType(),this.addLearnedByPokemon(),this.createProductList()},async exportTypeNamesList(){await this.createTypeUrlList(),await this.getTypeList(),this.getTypeNamesList()},async getMachines(){try{const t=await r.get(`${o}/item-category/37`);this.machines=t.data.items||[]}catch(t){console.dir(t)}},async getMachineList(){try{await Promise.all(this.machines.map(async(t,s)=>{const e=await r.get(t.url);e.data.flavor_text_entries.length&&this.machineList.push(e.data)})),this.machineList=this.machineList.sort(function(t,s){return t.id<s.id?-1:1})}catch(t){console.dir(t)}},async getMoveUrlList(){try{await Promise.all(this.machineList.map(async(t,s)=>{const e=await r.get(t.machines[0].machine.url);e.data&&this.moveUrlList.push(e.data)}))}catch(t){console.dir(t)}},async getMoveList(){try{await Promise.all(this.moveUrlList.map(async(t,s)=>{const e=await r.get(t.move.url);e.data&&this.moveList.push(e.data)})),this.moveList=this.moveList.sort(function(t,s){return t.machines[0].machine.url<s.machines[0].machine.url?-1:1})}catch(t){console.dir(t)}},async createTypeUrlList(){try{(await r.get(`${o}/type`)).data.results.forEach((s,e)=>{this.typeUrlList.push({url:s.url}),this.typeUrlList[e].name=s.name})}catch(t){n.fire({position:"top-end",icon:"false",title:"讀取屬性清單失敗，請聯繫管理員",showConfirmButton:!1,timer:1e3}),console.dir(t),this.isAttributesLoading=!1}},async getTypeList(){try{await Promise.all(this.typeUrlList.map(async(t,s)=>{const e=await r.get(t.url);e.data&&this.typeList.push(e.data),this.isAttributesLoading=!1}))}catch(t){n.fire({position:"top-end",icon:"false",title:"讀取屬性清單失敗，請聯繫管理員",showConfirmButton:!1,timer:1e3}),console.dir(t),this.isAttributesLoading=!1}},getTypeNamesList(){const t=[];this.typeList.forEach(a=>{t.push(a.names)});const s=[];t.forEach(a=>{s.push(a.filter(i=>i.language.name==="zh-Hant")[0].name||a[0].name)});const e=[];t.forEach(a=>{e.push(a.filter(i=>i.language.name==="en")[0].name||a[0].name)}),e.forEach((a,i)=>{this.typeNameList[a.toLowerCase()]=s[i]}),delete this.typeNameList["???"]},createSummarizedProductList(){this.machineList.forEach(t=>{this.summarizedProductList.push({})})},addMoveText(){const t=[];this.moveList.forEach(e=>{t.push(e.flavor_text_entries)});const s=[];t.forEach(e=>{s.push(e.filter(a=>a.language.name==="zh-Hant")[0]||e[0])}),s.forEach((e,a)=>{this.summarizedProductList[a].text=e.flavor_text})},addMoveName(){const t=[];this.moveList.forEach(e=>{t.push(e.names)});const s=[];t.forEach(e=>{s.push(e.filter(a=>a.language.name==="zh-Hant")[0]||e[0])}),s.forEach((e,a)=>{this.summarizedProductList[a].move_name=e.name})},addMoveType(){this.moveList.forEach((t,s)=>{this.summarizedProductList[s].type=this.typeNameList[t.type.name.toLowerCase()]})},addLearnedByPokemon(){this.moveList.forEach((t,s)=>{this.summarizedProductList[s].learned_by_pokemon=t.learned_by_pokemon})},stringifyLearnedByPokemon(t){const s=[];return t.forEach(e=>{s.push(JSON.stringify(e))}),s},addMachineName(){const t=[];this.machineList.forEach(e=>{t.push(e.names)});const s=[];t.forEach(e=>{s.push(e.filter(a=>a.language.name==="zh-Hant")[0]||e[0])}),s.forEach((e,a)=>{this.summarizedProductList[a].machine_name=e.name})},addCost(){this.machineList.forEach((t,s)=>{this.summarizedProductList[s].cost=t.cost})},addId(){this.machineList.forEach((t,s)=>{this.summarizedProductList[s].id=t.name})},addMachinePhoto(){this.machineList.forEach((t,s)=>{this.summarizedProductList[s].photo=t.sprites.default})},createProductList(){this.summarizedProductList.forEach(t=>{this.productList.push({origin_price:t.cost||9999,content:t.id,imagesUrl:this.stringifyLearnedByPokemon(t.learned_by_pokemon),title:t.machine_name,category:t.move_name,imageUrl:t.photo,description:t.text,unit:t.type,price:t.cost*.8||9999,is_enabled:1})})},async createSpeciesUrlList(){try{(await r.get(`${o}/pokemon-species?offset=0&limit=${this.pokemonCount}`)).data.results.forEach((s,e)=>{this.speciesUrlList.push({url:s.url}),this.speciesUrlList[e].name=s.name})}catch(t){console.dir(t)}},async getSpeciesList(){try{await Promise.all(this.speciesUrlList.map(async(t,s)=>{const e=await r.get(t.url);e.data&&this.speciesList.push(e.data)}))}catch(t){console.dir(t)}},getSpeciesNamesList(){const t=[];this.speciesList.forEach(a=>{t.push(a.names)});const s=[];t.forEach(a=>{s.push(a.filter(i=>i.language.name==="zh-Hant")[0].name||a[0].name)});const e=[];t.forEach(a=>{e.push(a.filter(i=>i.language.name==="en")[0].name||a[0].name)}),e.forEach((a,i)=>{this.speciesNameList[a.toLowerCase()]=s[i]})},async getPokemons(){const t=[];for(let a=1;a<=this.pokemonCount;a++)t.push(r.get(`${o}/pokemon/${a}`));const s={};(await Promise.all(t)).forEach(a=>{s[a.data.name]=a.data,s[a.data.name].chineseName=this.speciesNameList[a.data.name]}),this.pokemons={...s},this.isPokemonsLoading=!1},createTypeColorList(){this.typeColorList={fighting:"#8f191b",flying:"#81b9ef",normal:"#9fa19f",ghost:"#704170",steel:"#60a1b8",fire:"#e62829",rock:"#afa981",grass:"#3fa129",water:"#2980ef",electric:"#fac000",ground:"#915121",poison:"#9141cb",bug:"#b3c163",fairy:"#ef70ef",ice:"#3fd8ff",shadow:"#44685e",dragon:"#5060e1",psychic:"#f05388",dark:"#50413f"}}}});export{p};
