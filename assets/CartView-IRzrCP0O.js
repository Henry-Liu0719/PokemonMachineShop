import{_ as j,m as U,k as F,S as q,a as L,r as O,o as e,c as n,d as r,e as a,b as t,h as c,F as b,g as m,l as B,v as I,t as d,n as h,q as H,i as A}from"./index-kLIKSioy.js";import{c as M}from"./cartStore-3cS_AljZ.js";import{p as R}from"./productStore-cFCic3D3.js";import{_ as g}from"./Animation - 1710557059960-SOXLnD8x.js";var z={VITE_URL:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"popovgo",VITE_POKEMON_API:"https://pokeapi.co/api/v2",BASE_URL:"/PokemonMachineShop/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:K,VITE_PATH:x}=z,G={data(){return{productId:"",num:1,couponCode:""}},mounted(){this.getCart(),this.getProducts()},methods:{...U(M,["getCart","deleteCart","updateCart"]),...U(R,["openModal","addToCart","getProducts","filterType","getAllProducts"]),postCoupon(s){this.isUpdating=!0;const i={data:{code:`${s}`}};F.post(`${K}/api/${x}/coupon`,i).then(u=>{this.getCart(),q.fire({title:"使用優惠券成功",icon:"success",timer:1e3,showConfirmButton:!1,showCancelButton:!1})}).catch(u=>{q.fire({position:"top-end",icon:"error",title:`${u.response.data.message}`,showConfirmButton:!1,timer:1e3}),console.dir(u)}).finally(()=>{this.isUpdating=!1})}},computed:{...L(M,["carts","isCartsLoading"]),...L(R,["products","isProductsLoading","allProducts"])},watch:{num(){this.num=this.num<1?1:this.num}}},J={class:"container"},Q=t("img",{src:g,alt:"讀取中",class:"img-fluid"},null,-1),W={class:"mt-3 fs-4"},X=t("h3",{class:"mt-3 mb-4 fs-1"},"購物車",-1),Y={key:0,class:"p-0 container d-flex"},Z=t("h4",{class:"my-auto"},"購物車無商品",-1),tt=t("div",{class:"my-auto"},"前往產品列表",-1),ot={key:1,class:"row"},st={class:"col-md-8"},et={class:"table"},nt=t("thead",null,[t("tr",null,[t("th",{scope:"col",class:"border-0 ps-0"},"品名"),t("th",{scope:"col",class:"border-0"},"數量"),t("th",{scope:"col",class:"border-0"},"單價"),t("th",{scope:"col",class:"border-0"})])],-1),it={scope:"row",class:"border-0 px-0 font-weight-normal py-4"},dt=["src"],at={class:"mb-0 fw-bold ms-3 d-inline-block"},lt={class:"border-0 align-middle",style:{"max-width":"160px"}},rt={class:"input-group pe-5"},ct={class:"input-group-prepend"},ut=["onClick"],pt=t("i",{class:"bi bi-dash"},null,-1),_t=[pt],ht=["onUpdate:modelValue"],bt={class:"input-group-append"},mt=["onClick"],gt=t("i",{class:"bi bi-plus"},null,-1),ft=[gt],vt={class:"border-0 align-middle"},yt={class:"mb-0 ms-auto"},Ct={class:"border-0 align-middle"},kt=["onClick"],wt={class:"input-group w-50 mb-3"},Pt={class:"input-group-append"},Tt=["disabled"],Vt=t("i",{class:"bi bi-send"},null,-1),$t=[Vt],Et={class:"col-md-4"},Nt={class:"border p-4 mb-4"},St=t("h4",{class:"fw-bold mb-4"},"訂單詳情",-1),Ut={class:"d-flex justify-content-between mt-4"},qt=t("p",{class:"mb-0 h4 fw-bold"},"Total",-1),Lt={class:"mb-0 h4 fw-bold"},Ot={class:"col-12"},Bt=t("h3",{class:"my-3"},"查看更多商品",-1),It={class:"vl-parent"},At={key:0,src:g,alt:"讀取中",class:"img-fluid opacity-0"},Mt=t("img",{src:g,alt:"讀取中",class:"img-fluid"},null,-1),Rt={class:"row"},Dt={class:"card border-0 mb-4 position-relative position-relative"},jt=["src"],Ft={class:"card-body p-0"},Ht={class:"mb-0 mt-3"},zt={class:"card-text mb-0"},Kt={class:"text-muted"},xt=t("p",{class:"text-muted mt-3"},null,-1),Gt={key:0,class:"d-flex justify-content-center"},Jt={class:"pagination pagination-lg"},Qt={class:"page-item"},Wt=t("span",{"aria-hidden":"true"},"«",-1),Xt=[Wt],Yt=["onClick"],Zt={class:"page-item"},to=t("span",{"aria-hidden":"true"},"»",-1),oo=[to];function so(s,i,u,eo,p,D){var v,y,C,k,w,P,T,V,$,E,N,S;const f=O("loadingOverlay"),_=O("router-link");return e(),n("div",J,[r(f,{active:s.isCartsLoading,"is-full-page":!0},{default:a(()=>[Q]),_:1},8,["active"]),t("div",W,[X,(v=s.carts.carts)!=null&&v.length?c("",!0):(e(),n("div",Y,[Z,r(_,{class:"btn btn-danger rounded w-auto mx-2 mb-2",to:"products"},{default:a(()=>[tt]),_:1})])),(y=s.carts.carts)!=null&&y.length?(e(),n("div",ot,[t("div",st,[t("table",et,[nt,t("tbody",null,[(e(!0),n(b,null,m(s.carts.carts,o=>(e(),n("tr",{key:o.id,class:"border-bottom border-top"},[t("th",it,[t("img",{src:o.product.imageUrl,alt:"",style:{width:"72px",height:"72px","object-fit":"cover"}},null,8,dt),t("p",at,d(o.product.title)+" "+d(o.product.unit),1)]),t("td",lt,[t("div",rt,[t("div",ct,[t("button",{class:"btn btn-outline-dark border-0 py-2",type:"button",id:"button-addon1",onClick:l=>{o.qty--,s.updateCart(o,o.qty)}},_t,8,ut)]),B(t("input",{type:"text",class:"form-control border-0 text-center my-auto shadow-none",placeholder:"","aria-label":"Example text with button addon","aria-describedby":"button-addon1","onUpdate:modelValue":l=>o.qty=l,readonly:""},null,8,ht),[[I,o.qty]]),t("div",bt,[t("button",{class:"btn btn-outline-dark border-0 py-2",type:"button",id:"button-addon2",onClick:l=>{o.qty++,s.updateCart(o,o.qty)}},ft,8,mt)])])]),t("td",vt,[t("p",yt,"NT$"+d(o.total),1)]),t("td",Ct,[t("i",{class:"bi bi-x",onClick:l=>s.deleteCart(o.id)},null,8,kt)])]))),128))])]),t("div",wt,[B(t("input",{type:"text",class:"form-control rounded-0 border-bottom border-top-0 border-start-0 border-end-0 shadow-none",placeholder:"輸入優惠券gopopov即享50%折價","aria-label":"Recipient's username","aria-describedby":"button-addon2","onUpdate:modelValue":i[0]||(i[0]=o=>p.couponCode=o)},null,512),[[I,p.couponCode]]),t("div",Pt,[t("button",{class:"btn btn-outline-dark border-bottom border-top-0 border-start-0 border-end-0 rounded-0",type:"button",id:"button-addon2",onClick:i[1]||(i[1]=o=>D.postCoupon(p.couponCode)),disabled:p.couponCode===""},$t,8,Tt)])])]),t("div",Et,[t("div",Nt,[St,t("div",Ut,[qt,t("p",Lt,"NT$"+d(s.carts.final_total),1)]),r(_,{to:"checkout",class:h(["btn btn-dark w-100 mt-4 fs-4",{disabled:!((k=(C=s.carts)==null?void 0:C.carts)!=null&&k.length)}])},{default:a(()=>[A("送出訂單")]),_:1},8,["class"])])])])):c("",!0),t("div",Ot,[Bt,t("div",It,[(w=s.products)!=null&&w.products?c("",!0):(e(),n("img",At)),s.isCartsLoading?c("",!0):(e(),H(f,{key:1,active:s.isProductsLoading,"is-full-page":!1},{default:a(()=>[Mt]),_:1},8,["active"]))]),t("div",Rt,[(e(!0),n(b,null,m(s.products.products,o=>(e(),n("div",{class:"col-12 col-md-3 col-lg-2",key:o.id},[t("div",Dt,[r(_,{to:{path:"product",query:{id:o.id}}},{default:a(()=>[t("img",{src:o.imageUrl,class:"card-img-top object-fit-contain position-relative rounded border border-1 border-secondary",alt:"product.description",style:{width:"100%"}},null,8,jt)]),_:2},1032,["to"]),t("div",Ft,[r(_,{to:{path:"product",query:{id:o.id}},style:{"text-decoration":"none"}},{default:a(()=>[t("h4",Ht,d(o.content)+" "+d(o.unit),1)]),_:2},1032,["to"]),t("p",zt,[A("NT$"+d(Math.round(o.price*.8))+" ",1),t("span",Kt,[t("del",null,"NT$"+d(o.origin_price),1)])]),xt])])]))),128))]),!((T=(P=s.filterdProducts)==null?void 0:P.products)!=null&&T.length)==0?(e(),n("nav",Gt,[t("ul",Jt,[t("li",Qt,[t("button",{type:"button",class:h(["page-link",{disabled:!(($=(V=s.filterdProducts)==null?void 0:V.pagination)!=null&&$.has_pre)}]),"aria-label":"Previous",onClick:i[2]||(i[2]=o=>s.getProducts(s.products.pagination.current_page-1,s.yOffset))},Xt,2)]),(e(!0),n(b,null,m((E=s.filterdProducts.pagination)==null?void 0:E.total_pages,o=>(e(),n("li",{class:h(["page-item",{active:s.filterdProducts.pagination.current_page==o}]),key:o},[t("button",{class:"page-link",onClick:l=>s.getProducts(o,s.yOffset)},d(o),9,Yt)],2))),128)),t("li",Zt,[t("button",{type:"button",class:h(["page-link",{disabled:!((S=(N=s.filterdProducts)==null?void 0:N.pagination)!=null&&S.has_next)}]),"aria-label":"Next",onClick:i[3]||(i[3]=o=>s.getProducts(s.products.pagination.current_page+1,s.yOffset))},oo,2)])])])):c("",!0)])])])}const ro=j(G,[["render",so]]);export{ro as default};
