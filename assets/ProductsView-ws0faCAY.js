import{_ as V,a as u,p as N,m as p,r as T,o as r,c as a,b as t,d as h,e as m,n as d,F as l,g as _,t as n,h as $,j as q,i as j}from"./index-kLIKSioy.js";import{p as F}from"./productStore-cFCic3D3.js";import{f as L}from"./favoriteStore-jmKrEK12.js";import{_ as x}from"./Animation - 1710557059960-SOXLnD8x.js";const B={data(){return{yOffset:0,filterdProducts:{},searchedProducts:{},typeSelected:"全部"}},components:{},mounted(){this.init(),this.yOffset=document.querySelector("div.container.mt-md-5.mt-3.mb-7 > div > div.col-8 > div > h4").getBoundingClientRect().top+window.pageYOffset},computed:{...u(F,["products","isProductsLoading","allProducts"]),...u(N,["typeNameList"]),...u(L,["favorites"])},watch:{async products(){this.filterdProducts={...this.products},this.$route.query.keyWord&&await this.getAllProducts()},allProducts(){this.filterdProducts={...this.allProducts},this.createSearchedProducts()}},methods:{...p(F,["openModal","addToCart","getProducts","filterType","getAllProducts"]),...p(N,["exportTypeNamesList"]),...p(L,["addToFavorites","removeFromFavorites","getFavorites"]),async init(){const s=this.$route.query.category||"";await this.getProducts(1,0,s),this.exportTypeNamesList()},filterType(s="岩石"){this.filterdProducts.products=this.products.products.filter(i=>i.unit===s),window.scrollTo({top:this.yOffset,behavior:"smooth"})},async createSearchedProducts(){const s=this.$route.query.keyWord;console.log("this.filterdProducts",this.filterdProducts),this.searchedProducts={success:!0,products:[],pagination:{total_pages:1,current_page:1,has_pre:!1,has_next:!1,category:""},messages:[]},this.searchedProducts.products=this.filterdProducts.products.filter(i=>i.description.includes(s)||i.unit.includes(s)||i.pokemons.some(g=>g.name===s)),console.log("this.searchedProducts",this.searchedProducts),this.filterdProducts={...this.searchedProducts}}}},A=t("div",{class:"container"},null,-1),E={class:"container mt-md-5 mt-3 mb-7 mx-1"},M=t("img",{src:x,alt:"讀取中",class:"img-fluid"},null,-1),z={class:"row"},D={class:"col-4 col-md-3"},R={class:"accordion border border-bottom border-top-0 border-start-0 border-end-0 mb-3",id:"accordionExample"},U={class:"card border-0 mx-3"},Y=t("div",{class:"card-header px-0 py-4 bg-white border-0",id:"headingOne","data-bs-toggle":"collapse","data-bs-target":"#collapseOne"},[t("div",{class:""},[t("h3",{class:"mb-0 text-center"}," 屬性瀏覽 ")])],-1),G={id:"collapseOne",class:"collapse show","aria-labelledby":"headingOne","data-bs-parent":"#accordionExample"},H={class:"py-0"},I={class:"list-group"},J=["onClick"],K={class:"col-8 col-md-9"},Q={class:"row"},X={class:"card border-0 mb-4 position-relative position-relative"},Z=["src"],tt=["onClick"],et=t("i",{class:"bi bi-heart"},null,-1),st=t("span",{class:"visually-hidden"},"unread messages",-1),ot=[et,st],it=["onClick"],rt=t("i",{class:"bi bi-heart"},null,-1),at=t("span",{class:"visually-hidden"},"unread messages",-1),dt=[rt,at],nt={class:"card-body p-0"},ct={class:"mb-0 mt-3"},lt={class:"card-text mb-0"},ut={class:"text-muted"},pt=t("p",{class:"text-muted mt-3"},null,-1),ht={key:0,class:"d-flex justify-content-center"},mt={class:"pagination pagination-lg"},_t={class:"page-item"},gt=t("span",{"aria-hidden":"true"},"«",-1),yt=[gt],ft=["onClick"],bt={class:"page-item"},vt=t("span",{"aria-hidden":"true"},"»",-1),Pt=[vt];function kt(s,i,g,wt,o,Ct){var f,b,v,P,k,w,C,O,S;const W=T("loadingOverlay"),y=T("router-link");return r(),a(l,null,[A,t("div",E,[h(W,{active:s.isProductsLoading,"is-full-page":!0},{default:m(()=>[M]),_:1},8,["active"]),t("div",z,[t("div",D,[t("div",R,[t("div",U,[Y,t("div",G,[t("div",H,[t("ul",I,[t("button",{type:"button",href:"#",class:"page-link fs-5",onClick:i[0]||(i[0]=e=>{o.typeSelected="全部",this.$route.query.keyWord="",s.isLoading=!0,s.getProducts(1,o.yOffset,"")})},[t("li",{class:d(["list-group-item py-2 px-2",{active:o.typeSelected=="全部"}])}," 瀏覽全部 ",2)]),(r(!0),a(l,null,_(Object.entries(s.typeNameList),e=>(r(),a("button",{type:"button",href:"#",class:"page-link fs-5",key:e[0]},[t("li",{class:d(["list-group-item py-2 px-2",{active:o.typeSelected==e[0]}]),onClick:c=>{this.typeSelected=e[0],this.$route.query.keyWord="",s.isLoading=!0,s.getProducts(1,o.yOffset,e[1])}},n(e[1]),11,J)]))),128))])])])])])]),t("div",K,[t("div",Q,[t("h4",{class:d(["opacity-0 mt-6",{"opacity-100":!((f=o.filterdProducts.products)!=null&&f.length)}])},"無相符的查詢結果",2),t("h4",{class:d(["opacity-0 mt-6",{"opacity-100":(b=s.$route.query.keyWord)==null?void 0:b.length}])},"「"+n(s.$route.query.keyWord)+"」的招式機配對結果",3),(r(!0),a(l,null,_(o.filterdProducts.products,e=>(r(),a("div",{class:"col-12 col-md-4 col-lg-3",key:e.id},[t("div",X,[h(y,{to:{path:"product",query:{id:e.id}}},{default:m(()=>[t("img",{src:e.imageUrl,class:"card-img-top object-fit-contain position-relative rounded border border-1 border-secondary",alt:"product.description",style:{width:"100%"}},null,8,Z)]),_:2},1032,["to"]),t("span",null,[s.favorites.some(c=>c.id===e.id)?(r(),a("button",{key:1,type:"button",class:"position-absolute top-0 start-100 badge bg-primary border-0",style:{transform:"translate(-100%, 0)",width:"3rem",height:"1.5rem","border-radius":"0 0.375rem"},onClick:q(c=>s.removeFromFavorites(e.id),["prevent"])},dt,8,it)):(r(),a("button",{key:0,type:"button",class:"position-absolute top-0 start-100 badge bg-secondary border-0",style:{transform:"translate(-100%, 0)",width:"3rem",height:"1.5rem","border-radius":"0 0.375rem"},onClick:q(c=>s.addToFavorites(e),["prevent"])},ot,8,tt))]),t("div",nt,[h(y,{to:{path:"product",query:{id:e.id}},style:{"text-decoration":"none"}},{default:m(()=>[t("h4",ct,n(e.content)+" "+n(e.unit),1)]),_:2},1032,["to"]),t("p",lt,[j("NT$"+n(Math.round(e.price*.8))+" ",1),t("span",ut,[t("del",null,"NT$"+n(e.origin_price),1)])]),pt])])]))),128))]),!((P=(v=o.filterdProducts)==null?void 0:v.products)!=null&&P.length)==0?(r(),a("nav",ht,[t("ul",mt,[t("li",_t,[t("button",{type:"button",class:d(["page-link",{disabled:!((w=(k=o.filterdProducts)==null?void 0:k.pagination)!=null&&w.has_pre)}]),"aria-label":"Previous",onClick:i[1]||(i[1]=e=>s.getProducts(s.products.pagination.current_page-1,o.yOffset))},yt,2)]),(r(!0),a(l,null,_((C=o.filterdProducts.pagination)==null?void 0:C.total_pages,e=>(r(),a("li",{class:d(["page-item",{active:o.filterdProducts.pagination.current_page==e}]),key:e},[t("button",{class:"page-link",onClick:c=>s.getProducts(e,o.yOffset)},n(e),9,ft)],2))),128)),t("li",bt,[t("button",{type:"button",class:d(["page-link",{disabled:!((S=(O=o.filterdProducts)==null?void 0:O.pagination)!=null&&S.has_next)}]),"aria-label":"Next",onClick:i[2]||(i[2]=e=>s.getProducts(s.products.pagination.current_page+1,o.yOffset))},Pt,2)])])])):$("",!0)])])])],64)}const qt=V(B,[["render",kt]]);export{qt as default};
