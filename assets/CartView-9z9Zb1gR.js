import{_ as R,m as E,k as D,S as N,a as S,r as U,o as n,c as i,d as l,w as r,b as t,h,F as b,g as m,l as O,v as q,t as d,n as _,i as B}from"./index-24ledW0-.js";import{c as I}from"./cartStore-HeSIVGNu.js";import{p as L}from"./productStore--N9LsBtN.js";import{_ as j}from"./Animation - 1710557059960-SOXLnD8x.js";var x={VITE_URL:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"popovgo",VITE_POKEMON_API:"https://pokeapi.co/api/v2",BASE_URL:"/PokemonMachineShop/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:F,VITE_PATH:H}=x,z={data(){return{productId:"",num:1,couponCode:""}},mounted(){this.getCart(),this.getProducts()},methods:{...E(I,["getCart","deleteCart","updateCart"]),...E(L,["openModal","addToCart","getProducts","filterType","getAllProducts"]),postCoupon(s){this.isUpdating=!0;const e={data:{code:`${s}`}};D.post(`${F}/api/${H}/coupon`,e).then(c=>{this.getCart(),N.fire({title:"使用優惠券成功",icon:"success",timer:1e3,showConfirmButton:!1,showCancelButton:!1})}).catch(c=>{N.fire({position:"top-end",icon:"error",title:`${c.response.data.message}`,showConfirmButton:!1,timer:1e3}),console.dir(c)}).finally(()=>{this.isUpdating=!1})}},computed:{...S(I,["carts","isCartsLoading"]),...S(L,["products","isProductsLoading","allProducts"])},watch:{num(){this.num=this.num<1?1:this.num}}},K={class:"container"},G=t("img",{src:j,alt:"讀取中",class:"img-fluid"},null,-1),J={class:"mt-3 fs-4"},Q=t("h3",{class:"mt-3 mb-4 fs-1"},"購物車",-1),W={key:0,class:"p-0 container d-flex"},X=t("h4",{class:"my-auto"},"購物車無商品",-1),Y=t("div",{class:"my-auto"},"前往產品列表",-1),Z={key:1,class:"row"},tt={class:"col-md-8"},ot={class:"table"},st=t("thead",null,[t("tr",null,[t("th",{scope:"col",class:"border-0 ps-0"},"品名"),t("th",{scope:"col",class:"border-0"},"數量"),t("th",{scope:"col",class:"border-0"},"單價"),t("th",{scope:"col",class:"border-0"})])],-1),et={scope:"row",class:"border-0 px-0 font-weight-normal py-4"},nt=["src"],it={class:"mb-0 fw-bold ms-3 d-inline-block"},dt={class:"border-0 align-middle",style:{"max-width":"160px"}},at={class:"input-group pe-5"},lt={class:"input-group-prepend"},rt=["onClick"],ct=t("i",{class:"bi bi-dash"},null,-1),pt=[ct],ut=["onUpdate:modelValue"],_t={class:"input-group-append"},ht=["onClick"],bt=t("i",{class:"bi bi-plus"},null,-1),mt=[bt],gt={class:"border-0 align-middle"},ft={class:"mb-0 ms-auto"},vt={class:"border-0 align-middle"},yt=["onClick"],Ct={class:"input-group w-50 mb-3"},kt={class:"input-group-append"},wt=["disabled"],Pt=t("i",{class:"bi bi-send"},null,-1),Tt=[Pt],Vt={class:"col-md-4"},$t={class:"border p-4 mb-4"},Et=t("h4",{class:"fw-bold mb-4"},"訂單詳情",-1),Nt={class:"d-flex justify-content-between mt-4"},St=t("p",{class:"mb-0 h4 fw-bold"},"Total",-1),Ut={class:"mb-0 h4 fw-bold"},Ot={class:"col-12"},qt=t("h3",{class:"my-3"},"查看更多商品",-1),Bt={class:"row"},It={class:"card border-0 mb-4 position-relative position-relative"},Lt=["src"],At={class:"card-body p-0"},Mt={class:"mb-0 mt-3"},Rt={class:"card-text mb-0"},Dt={class:"text-muted"},jt=t("p",{class:"text-muted mt-3"},null,-1),xt={key:0,class:"d-flex justify-content-center"},Ft={class:"pagination pagination-lg"},Ht={class:"page-item"},zt=t("span",{"aria-hidden":"true"},"«",-1),Kt=[zt],Gt=["onClick"],Jt={class:"page-item"},Qt=t("span",{"aria-hidden":"true"},"»",-1),Wt=[Qt];function Xt(s,e,c,Yt,p,A){var g,f,v,y,C,k,w,P,T,V,$;const M=U("loadingOverlay"),u=U("router-link");return n(),i("div",K,[l(M,{active:s.isCartsLoading,"is-full-page":!0},{default:r(()=>[G]),_:1},8,["active"]),t("div",J,[Q,(g=s.carts.carts)!=null&&g.length?h("",!0):(n(),i("div",W,[X,l(u,{class:"btn btn-danger rounded w-auto mx-2 mb-2",to:"products"},{default:r(()=>[Y]),_:1})])),(f=s.carts.carts)!=null&&f.length?(n(),i("div",Z,[t("div",tt,[t("table",ot,[st,t("tbody",null,[(n(!0),i(b,null,m(s.carts.carts,o=>(n(),i("tr",{key:o.id,class:"border-bottom border-top"},[t("th",et,[t("img",{src:o.product.imageUrl,alt:"",style:{width:"72px",height:"72px","object-fit":"cover"}},null,8,nt),t("p",it,d(o.product.title)+" "+d(o.product.unit),1)]),t("td",dt,[t("div",at,[t("div",lt,[t("button",{class:"btn btn-outline-dark border-0 py-2",type:"button",id:"button-addon1",onClick:a=>{o.qty--,s.updateCart(o,o.qty)}},pt,8,rt)]),O(t("input",{type:"text",class:"form-control border-0 text-center my-auto shadow-none",placeholder:"","aria-label":"Example text with button addon","aria-describedby":"button-addon1","onUpdate:modelValue":a=>o.qty=a,readonly:""},null,8,ut),[[q,o.qty]]),t("div",_t,[t("button",{class:"btn btn-outline-dark border-0 py-2",type:"button",id:"button-addon2",onClick:a=>{o.qty++,s.updateCart(o,o.qty)}},mt,8,ht)])])]),t("td",gt,[t("p",ft,"NT$"+d(o.total),1)]),t("td",vt,[t("i",{class:"bi bi-x",onClick:a=>s.deleteCart(o.id)},null,8,yt)])]))),128))])]),t("div",Ct,[O(t("input",{type:"text",class:"form-control rounded-0 border-bottom border-top-0 border-start-0 border-end-0 shadow-none",placeholder:"輸入優惠券gopopov即享50%折價","aria-label":"Recipient's username","aria-describedby":"button-addon2","onUpdate:modelValue":e[0]||(e[0]=o=>p.couponCode=o)},null,512),[[q,p.couponCode]]),t("div",kt,[t("button",{class:"btn btn-outline-dark border-bottom border-top-0 border-start-0 border-end-0 rounded-0",type:"button",id:"button-addon2",onClick:e[1]||(e[1]=o=>A.postCoupon(p.couponCode)),disabled:p.couponCode===""},Tt,8,wt)])])]),t("div",Vt,[t("div",$t,[Et,t("div",Nt,[St,t("p",Ut,"NT$"+d(s.carts.final_total),1)]),l(u,{to:"checkout",class:_(["btn btn-dark w-100 mt-4 fs-4",{disabled:!((y=(v=s.carts)==null?void 0:v.carts)!=null&&y.length)}])},{default:r(()=>[B("送出訂單")]),_:1},8,["class"])])])])):h("",!0),t("div",Ot,[qt,t("div",Bt,[(n(!0),i(b,null,m(s.products.products,o=>(n(),i("div",{class:"col-12 col-md-3 col-lg-2",key:o.id},[t("div",It,[l(u,{to:{path:"product",query:{id:o.id}}},{default:r(()=>[t("img",{src:o.imageUrl,class:"card-img-top object-fit-contain position-relative rounded border border-1 border-secondary",alt:"product.description",style:{width:"100%"}},null,8,Lt)]),_:2},1032,["to"]),t("div",At,[l(u,{to:{path:"product",query:{id:o.id}},style:{"text-decoration":"none"}},{default:r(()=>[t("h4",Mt,d(o.content)+" "+d(o.unit),1)]),_:2},1032,["to"]),t("p",Rt,[B("NT$"+d(Math.round(o.price*.8))+" ",1),t("span",Dt,[t("del",null,"NT$"+d(o.origin_price),1)])]),jt])])]))),128))]),!((k=(C=s.filterdProducts)==null?void 0:C.products)!=null&&k.length)==0?(n(),i("nav",xt,[t("ul",Ft,[t("li",Ht,[t("button",{type:"button",class:_(["page-link",{disabled:!((P=(w=s.filterdProducts)==null?void 0:w.pagination)!=null&&P.has_pre)}]),"aria-label":"Previous",onClick:e[2]||(e[2]=o=>s.getProducts(s.products.pagination.current_page-1,s.yOffset))},Kt,2)]),(n(!0),i(b,null,m((T=s.filterdProducts.pagination)==null?void 0:T.total_pages,o=>(n(),i("li",{class:_(["page-item",{active:s.filterdProducts.pagination.current_page==o}]),key:o},[t("button",{class:"page-link",onClick:a=>s.getProducts(o,s.yOffset)},d(o),9,Gt)],2))),128)),t("li",Jt,[t("button",{type:"button",class:_(["page-link",{disabled:!(($=(V=s.filterdProducts)==null?void 0:V.pagination)!=null&&$.has_next)}]),"aria-label":"Next",onClick:e[3]||(e[3]=o=>s.getProducts(s.products.pagination.current_page+1,s.yOffset))},Wt,2)])])])):h("",!0)])])])}const eo=R(z,[["render",Xt]]);export{eo as default};
