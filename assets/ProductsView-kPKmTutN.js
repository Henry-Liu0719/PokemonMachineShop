import{_ as U,a as u,p as F,m as p,r as W,o as i,c as r,b as t,d as h,e as _,n,F as m,g as y,t as c,h as $,j as g,i as M}from"./index-1BOxTqVS.js";import{p as V}from"./productStore-3Se7VwP2.js";import{f as j}from"./favoriteStore-fFlbOv9X.js";import{c as B}from"./cartStore-SkugQs_N.js";import{_ as A}from"./Animation - 1710557059960-SOXLnD8x.js";const z={data(){return{yOffset:0,filterdProducts:{},searchedProducts:{},typeSelected:"全部"}},components:{},mounted(){this.init(),this.yOffset=document.querySelector("div.container.mt-md-5.mt-3.mb-7 > div > div.col-8 > div > h4").getBoundingClientRect().top+window.pageYOffset},computed:{...u(V,["products","isProductsLoading","allProducts"]),...u(F,["typeNameList"]),...u(j,["favorites"]),...u(B,["carts","isCartsLoading","isUpdating"])},watch:{async products(){this.filterdProducts={...this.products},this.$route.query.keyWord&&await this.getAllProducts()},allProducts(){this.filterdProducts={...this.allProducts},this.createSearchedProducts()}},methods:{...p(V,["openModal","addToCart","getProducts","filterType","getAllProducts"]),...p(F,["exportTypeNamesList"]),...p(j,["addToFavorites","removeFromFavorites","getFavorites"]),...p(B,["getCart","addToCart","deleteCart"]),async init(){this.getCart();const e=this.$route.query.category||"";await this.getProducts(1,0,e),this.exportTypeNamesList()},filterType(e="岩石"){this.filterdProducts.products=this.products.products.filter(a=>a.unit===e),window.scrollTo({top:this.yOffset,behavior:"smooth"})},async createSearchedProducts(){const e=this.$route.query.keyWord;console.log("this.filterdProducts",this.filterdProducts),this.searchedProducts={success:!0,products:[],pagination:{total_pages:1,current_page:1,has_pre:!1,has_next:!1,category:""},messages:[]},this.searchedProducts.products=this.filterdProducts.products.filter(a=>a.description.includes(e)||a.unit.includes(e)||a.pokemons.some(b=>b.name===e)),console.log("this.searchedProducts",this.searchedProducts),this.filterdProducts={...this.searchedProducts}}}},D=t("div",{class:"container"},null,-1),R={class:"container mt-md-5 mt-3 mb-7 mx-1"},Y=t("img",{src:A,alt:"讀取中",class:"img-fluid"},null,-1),G={class:"row"},H={class:"col-4 col-md-3"},I={class:"accordion border border-bottom border-top-0 border-start-0 border-end-0 mb-3",id:"accordionExample"},J={class:"card border-0 mx-3"},K=t("div",{class:"card-header px-0 py-4 bg-white border-0",id:"headingOne","data-bs-toggle":"collapse","data-bs-target":"#collapseOne"},[t("div",{class:""},[t("h3",{class:"mb-0 text-center"}," 屬性瀏覽 ")])],-1),Q={id:"collapseOne",class:"collapse show","aria-labelledby":"headingOne","data-bs-parent":"#accordionExample"},X={class:"py-0"},Z={class:"list-group"},x=["onClick"],tt={class:"col-8 col-md-9"},et={class:"row"},st={class:"card border-0 mb-4 position-relative position-relative"},ot=["src"],it=t("img",{src:A,alt:"讀取中",class:"img-fluid"},null,-1),rt=["onClick"],at=t("i",{class:"bi bi-heart"},null,-1),dt=t("span",{class:"visually-hidden"},"unread messages",-1),nt=[at,dt],ct=["onClick"],lt=t("i",{class:"bi bi-heart"},null,-1),ut=t("span",{class:"visually-hidden"},"unread messages",-1),pt=[lt,ut],ht=["onClick"],_t=t("i",{class:"bi bi-cart"},null,-1),mt=t("span",{class:"visually-hidden"},"unread messages",-1),gt=[_t,mt],yt=["onClick"],bt=t("i",{class:"bi bi-cart"},null,-1),ft=t("span",{class:"visually-hidden"},"unread messages",-1),vt=[bt,ft],kt={class:"card-body p-0"},Pt={class:"mb-0 mt-3"},Ct={class:"card-text mb-0"},wt={class:"text-muted"},Ot={key:0},St=t("p",{class:"text-muted mt-3"},null,-1),Lt={key:0,class:"d-flex justify-content-center"},Tt={class:"pagination pagination-lg"},Nt={class:"page-item"},qt=t("span",{"aria-hidden":"true"},"«",-1),Ft=[qt],Wt=["onClick"],$t={class:"page-item"},Vt=t("span",{"aria-hidden":"true"},"»",-1),jt=[Vt];function Bt(e,a,b,At,o,Et){var k,P,C,w,O,S,L,T,N;const f=W("loadingOverlay"),v=W("router-link");return i(),r(m,null,[D,t("div",R,[h(f,{active:e.isProductsLoading,"is-full-page":!0},{default:_(()=>[Y]),_:1},8,["active"]),t("div",G,[t("div",H,[t("div",I,[t("div",J,[K,t("div",Q,[t("div",X,[t("ul",Z,[t("button",{type:"button",href:"#",class:"page-link fs-5",onClick:a[0]||(a[0]=s=>{o.typeSelected="全部",this.$route.query.keyWord="",e.isLoading=!0,e.getProducts(1,o.yOffset,"")})},[t("li",{class:n(["list-group-item py-2 px-2",{active:o.typeSelected=="全部"}])}," 瀏覽全部 ",2)]),(i(!0),r(m,null,y(Object.entries(e.typeNameList),s=>(i(),r("button",{type:"button",href:"#",class:"page-link fs-5",key:s[0]},[t("li",{class:n(["list-group-item py-2 px-2",{active:o.typeSelected==s[0]}]),onClick:l=>{this.typeSelected=s[0],this.$route.query.keyWord="",e.isLoading=!0,e.getProducts(1,o.yOffset,s[1])}},c(s[1]),11,x)]))),128))])])])])])]),t("div",tt,[t("div",et,[t("h4",{class:n(["opacity-0 mt-6",{"opacity-100":!((k=o.filterdProducts.products)!=null&&k.length)&&!e.isProductsLoading}])},"無相符的查詢結果",2),t("h4",{class:n(["opacity-0 mt-6",{"opacity-100":(P=e.$route.query.keyWord)==null?void 0:P.length}])},"「"+c(e.$route.query.keyWord)+"」的招式機配對結果",3),(i(!0),r(m,null,y(o.filterdProducts.products,s=>{var l,q;return i(),r("div",{class:"col-12 col-md-4 col-lg-3",key:s.id},[t("div",st,[h(v,{to:{path:"product",query:{id:s.id}},class:"vl-parent"},{default:_(()=>[t("img",{src:s.imageUrl,class:"card-img-top object-fit-contain position-relative rounded border border-1 border-secondary",alt:"product.description",style:{width:"100%"}},null,8,ot),h(f,{active:e.isUpdating,"is-full-page":!1},{default:_(()=>[it]),_:1},8,["active"])]),_:2},1032,["to"]),t("span",null,[e.favorites.some(d=>d.id===s.id)?(i(),r("button",{key:1,type:"button",class:"position-absolute top-0 start-0 badge bg-primary border-0",style:{width:"3rem",height:"1.5rem","border-radius":"0.375rem 0"},onClick:g(d=>e.removeFromFavorites(s.id),["prevent"])},pt,8,ct)):(i(),r("button",{key:0,type:"button",class:"position-absolute top-0 start-0 badge bg-secondary border-0",style:{width:"3rem",height:"1.5rem","border-radius":"0.375rem 0"},onClick:g(d=>e.addToFavorites(s),["prevent"])},nt,8,rt))]),t("span",null,[e.carts.carts.some(d=>d.product.id===s.id)?(i(),r("button",{key:1,type:"button",class:"position-absolute top-0 start-100 badge bg-primary border-0",style:{transform:"translate(-100%, 0)",width:"3rem",height:"1.5rem","border-radius":"0 0.375rem"},onClick:g(d=>e.deleteCart(e.carts.carts.filter(E=>E.product_id==s.id)[0].id),["prevent"])},vt,8,yt)):(i(),r("button",{key:0,type:"button",class:"position-absolute top-0 start-100 badge bg-secondary border-0",style:{transform:"translate(-100%, 0)",width:"3rem",height:"1.5rem","border-radius":"0 0.375rem"},onClick:g(d=>e.addToCart(s.id,1),["prevent"])},gt,8,ht))]),t("div",kt,[h(v,{to:{path:"product",query:{id:s.id}},style:{"text-decoration":"none"}},{default:_(()=>[t("h4",Pt,c(s.content)+" "+c(s.unit),1)]),_:2},1032,["to"]),t("p",Ct,[M("NT$"+c((l=s.price)==null?void 0:l.toLocaleString())+" ",1),t("span",wt,[s.price!=s.origin_price?(i(),r("del",Ot,"NT$"+c((q=s.origin_price)==null?void 0:q.toLocaleString()),1)):$("",!0)])]),St])])])}),128))]),!((w=(C=o.filterdProducts)==null?void 0:C.products)!=null&&w.length)==0?(i(),r("nav",Lt,[t("ul",Tt,[t("li",Nt,[t("button",{type:"button",class:n(["page-link",{disabled:!((S=(O=o.filterdProducts)==null?void 0:O.pagination)!=null&&S.has_pre)}]),"aria-label":"Previous",onClick:a[1]||(a[1]=s=>e.getProducts(e.products.pagination.current_page-1,o.yOffset))},Ft,2)]),(i(!0),r(m,null,y((L=o.filterdProducts.pagination)==null?void 0:L.total_pages,s=>(i(),r("li",{class:n(["page-item",{active:o.filterdProducts.pagination.current_page==s}]),key:s},[t("button",{class:"page-link",onClick:l=>e.getProducts(s,o.yOffset)},c(s),9,Wt)],2))),128)),t("li",$t,[t("button",{type:"button",class:n(["page-link",{disabled:!((N=(T=o.filterdProducts)==null?void 0:T.pagination)!=null&&N.has_next)}]),"aria-label":"Next",onClick:a[2]||(a[2]=s=>e.getProducts(e.products.pagination.current_page+1,o.yOffset))},jt,2)])])])):$("",!0)])])])],64)}const Yt=U(z,[["render",Bt]]);export{Yt as default};
